Imports System.Threading.Thread
Imports System.IO

Public Class TableCreation
    Dim sTableName As String = ""
    Dim cmb_Debit = New String(,) {{"C", "Credit"}, {"D", "Debit"}}

    Sub New()

        '/*EDefter*/
        EntegratorDegerleriTanim() 'Table
        ListeRaporlar()
        ListeRaporDeger2()

        '/*SON Edefter*/
    End Sub

#Region "       ... EDefter Entegrator Secim...     "

    Sub EntegratorDegerleriTanim()
        Try
            Me.EntegratorSecim()
            Sleep(1500)
            Me.EntegratorBelgeTanim()

            If Not oGFun.UDOExists("EInteg") Then
                Dim findAliasNDescription = New String(,) {{"DocNum", "DocNum"}}
                oGFun.RegisterUDO("EInteg", "Entegrator", SAPbobsCOM.BoUDOObjType.boud_Document, findAliasNDescription, "EIntegSel", "EIntegDocVal")
                findAliasNDescription = Nothing
            End If
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub

    Sub EntegratorSecim()
        Try
            sTableName = "@EIntegSel"
            oGFun.CreateTable("EIntegSel", "Entegrator Secimi", SAPbobsCOM.BoUTBTableType.bott_Document)
            oGFun.CreateUserFields(sTableName, "IntegratorCode", "Entegrator Kodu", SAPbobsCOM.BoFieldTypes.db_Numeric, 5)
            oGFun.CreateUserFields(sTableName, "IntegratorName", "Entegrator Adi", SAPbobsCOM.BoFieldTypes.db_Alpha, 25)

        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        Finally
        End Try
    End Sub


    Sub EntegratorBelgeTanim()
        Try
            sTableName = "@EIntegDocVal"
            oGFun.CreateTable("EIntegDocVal", "Entegrator Dokuman Deger", SAPbobsCOM.BoUTBTableType.bott_DocumentLines)
            oGFun.CreateUserFields(sTableName, "SAPBelgeTuru", "Belge Turu", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "BelTip", "E-Defter Belge Tipi", SAPbobsCOM.BoFieldTypes.db_Alpha, 30)
            oGFun.CreateUserFields(sTableName, "BelTipTanim", "Belge Tipi Aciklama", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub

#End Region

#Region "       ... EDefter Liste Raporlar...     "
    Sub ListeRaporlar()
        Try
            Me.ListeRaporlarHeader()
            Sleep(1000)
            Me.ListeRaporlarDetails()
            Sleep(1000)
            Me.ListeRaporDeger() 'Uyumsoft
            Sleep(1000)
            Me.ListeRaporDeger2() 'Huber İzibiz2
            Sleep(1000)
            Me.ListeRaporDeger3() 'İzibiz
            Sleep(1000)
            Me.ListeRaporDeger4() 'Bimsa
            Sleep(1000)
            If blnIsHANA Then
                Me.CreateEDefterExcel1_HANA()
                Sleep(1000)
                Me.CreateEDefterGrid1_HANA()
                Sleep(1000)
                'Me.CreateEDefterGrid2_HANA()
                'Sleep(1000)
                Me.CreateEDefterGrid3_HANA()
                Sleep(1000)
                Me.CreateEDefterExcel3_HANA()
                Sleep(1000)
                Me.CreateEDefterGrid4_HANA()
                Sleep(1000)
                Me.CreateEDefterText4_HANA()
            Else
                Me.CreateEDefterExcel1()
                Sleep(1000)
                Me.CreateEDefterGrid1()
                Sleep(1000)
                Me.CreateEDefterGrid2()
                Sleep(1000)
                Me.CreateEDefterGrid3()
                Sleep(1000)
                Me.CreateEDefterExcel3()
                Sleep(1000)
                Me.CreateEDefterGrid4()
                Sleep(1000)
                Me.CreateEDefterText4()
            End If
           

            If Not oGFun.UDOExists("ELRAP") Then
                Dim findAliasNDescription = New String(,) {{"DocNum", "DocNum"}}
                oGFun.RegisterUDO("ELRAP", "Liste Raporlar seçim ölçütleri", SAPbobsCOM.BoUDOObjType.boud_Document, findAliasNDescription, "ELRAPH", "ELRAPS", "ELRAPV", "ELRAPVH", "ELRAPVI", "ELRAPVB")
                findAliasNDescription = Nothing
            End If


        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub
    Sub ListeRaporlarHeader()
        Try
            sTableName = "@ELRAPH"
            oGFun.CreateTable("ELRAPH", "Liste Raporlar Baslik", SAPbobsCOM.BoUTBTableType.bott_Document)
            oGFun.CreateUserFields(sTableName, "RBASLIK", "Olcut Grup Adi", SAPbobsCOM.BoFieldTypes.db_Alpha, 30)

        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub
    Sub ListeRaporlarDetails()
        Try
            sTableName = "@ELRAPS"
            oGFun.CreateTable("ELRAPS", "Liste Rapor Olcut", SAPbobsCOM.BoUTBTableType.bott_DocumentLines)
            oGFun.CreateUserFields(sTableName, "PKayTar", "Kayit Tarihi", SAPbobsCOM.BoFieldTypes.db_Alpha, 1)
            oGFun.CreateUserFields(sTableName, "BasTar1", "Kayit Bas Tarihi", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "BitTar1", "Kayit Bit Tarihi", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "PBelTar", "Belge Tarihi", SAPbobsCOM.BoFieldTypes.db_Alpha, 1)
            oGFun.CreateUserFields(sTableName, "BasTar2", "Belge Bas Tarihi", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "BitTar2", "Belge Bit Tarihi", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "Guncellendi", "Belge Tarihi", SAPbobsCOM.BoFieldTypes.db_Alpha, 1)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub
    Sub ListeRaporDeger() 'Uyumsoft
        Try
            sTableName = "@ELRAPV"
            oGFun.CreateTable("ELRAPV", "Liste Rapor Degerler U", SAPbobsCOM.BoUTBTableType.bott_DocumentLines)
            oGFun.CreateUserFields(sTableName, "StartDate", "StartDate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "EndDate", "EndDate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "EnteredBy", "EnteredBy", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "EnteredDate", "EnteredDate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "EntryNumber", "EntryNumber", SAPbobsCOM.BoFieldTypes.db_Numeric, 8) 'numericti değişti
            oGFun.CreateUserFields(sTableName, "EntryComment", "EntryComment", SAPbobsCOM.BoFieldTypes.db_Alpha, 200)
            oGFun.CreateUserFields(sTableName, "BatchID", "BatchID", SAPbobsCOM.BoFieldTypes.db_Numeric)
            oGFun.CreateUserFields(sTableName, "BatchDescription", "BatchDescription", SAPbobsCOM.BoFieldTypes.db_Alpha, 200)
            oGFun.CreateUserFields(sTableName, "TotalDebit", "TotalDebit", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "TotalCredit", "TotalCredit", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "DocumentType", "DocumentType", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "DocTypeDesc", "DocumentTypeDescription", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "DocumentNumber", "DocumentNumber", SAPbobsCOM.BoFieldTypes.db_Alpha, 30) 'SAPbobsCOM.BoFieldTypes.db_Numeric, 5) 'değişen kısım
            oGFun.CreateUserFields(sTableName, "DocumentDate", "DocumentDate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "PaymentMethod", "PaymentMethod", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "AccountMainID", "AccountMainID", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "AccMainDesc", "AccountMainDescription", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "AccSubDesc", "AccountSubDescription", SAPbobsCOM.BoFieldTypes.db_Alpha, 200)
            oGFun.CreateUserFields(sTableName, "AccountSubID", "AccountSubID", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "Amount", "Amount", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "DebitCreditCode", "DebitCreditCode", SAPbobsCOM.BoFieldTypes.db_Alpha, 1)
            oGFun.CreateUserFields(sTableName, "PostingDate", "PostingDate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "DetailComment", "DetailComment", SAPbobsCOM.BoFieldTypes.db_Alpha, 250)


        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub
    Sub ListeRaporDeger2() 'Huber
        Try
            sTableName = "@ELRAPVH"
            oGFun.CreateTable("ELRAPVH", "Liste Rapor Degerler H", SAPbobsCOM.BoUTBTableType.bott_DocumentLines)

            oGFun.CreateUserFields(sTableName, "Yevmiye_Madde_No", "Yevmiye_Madde_Numarası", SAPbobsCOM.BoFieldTypes.db_Numeric, 8) 'int değeri
            oGFun.CreateUserFields(sTableName, "Fis_Numarasi", "Fiş_Numarası", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "Fis_Satir_No", "Fiş_Satır_No", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "Yevmiye_Tarihi", "Yevmiye_Tarihi", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "Fisi_Kaydeden", "Fişi_Kaydeden", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "Kayit_Acik", "Kayıt_Açıklaması", SAPbobsCOM.BoFieldTypes.db_Alpha, 250)
            oGFun.CreateUserFields(sTableName, "Toplam_Borc", "Toplam_Borc", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "Toplam_Alacak", "Toplam_Alacak", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)

            oGFun.CreateUserFields(sTableName, "Satir_Madde_No", "Satır_Madde_No", SAPbobsCOM.BoFieldTypes.db_Numeric, 8) 'int değeri

            oGFun.CreateUserFields(sTableName, "Ana_Hesap_Kodu", "Ana_Hesap_Kodu", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "Ana_Hesap_Acik", "Ana_Hesap_Açıklaması", SAPbobsCOM.BoFieldTypes.db_Alpha, 200)
            oGFun.CreateUserFields(sTableName, "Alt_Hesap_Kodu", "Alt_Hesap_Kodu", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "Alt_Hesap_Acik", "Alt_Hesap_Açıklaması", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "Borc", "Borç", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "Alacak", "Alacak", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "Dokuman_No", "Doküman_No", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "Dokuman_Tipi", "Doküman_Tipi", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "Dokuman_Tipi_Acik", "Doküman_Tipi_Açıklaması", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "Dokuman_Tarihi", "Doküman_Tarihi", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "Odeme_Yontemi", "Ödeme_Yöntemi", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "Fis_Detay_Acik", "Fiş_Detay_Açıklaması", SAPbobsCOM.BoFieldTypes.db_Alpha, 250)
            oGFun.CreateUserFields(sTableName, "Firma_No", "Firma_No", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "Sube_No", "Şube_No", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "Kaynak_Referansi", "Kaynak_Referansı", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)

        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub

    Sub ListeRaporDeger3() 'İzibiz
        Try
            sTableName = "@ELRAPVI"
            oGFun.CreateTable("ELRAPVI", "Liste Rapor Degerler I", SAPbobsCOM.BoUTBTableType.bott_DocumentLines)
            oGFun.CreateUserFields(sTableName, "transid", "TransID", SAPbobsCOM.BoFieldTypes.db_Numeric, 8) 'int değeri
            oGFun.CreateUserFields(sTableName, "detailref", "Satır_Madde_No", SAPbobsCOM.BoFieldTypes.db_Numeric, 8) 'int değeri
            oGFun.CreateUserFields(sTableName, "entryref", "entryref", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "linenumber", "linenumber", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "linenumbercounter", "Yevmiye_Madde_Numarası", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "accmainid", "accmainid", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "accmainiddesc", "accmainiddesc", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "accsubid", "accsubid", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "accsubdesc", "accsubdesc", SAPbobsCOM.BoFieldTypes.db_Alpha, 200)
            oGFun.CreateUserFields(sTableName, "amount", "amount", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "debitcreditcode", "debitcreditcode", SAPbobsCOM.BoFieldTypes.db_Alpha, 1)
            oGFun.CreateUserFields(sTableName, "postingdate", "postingdate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "documenttype", "documenttype", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "doctypedesc", "doctypedesc", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "documentnumber", "documentnumber", SAPbobsCOM.BoFieldTypes.db_Alpha, 30)
            oGFun.CreateUserFields(sTableName, "documentreference", "documentreference", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "entrynumbercounter", "Yevmiye_Madde_Numarası", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "documentdate", "documentdate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "paymentmethod", "paymentmethod", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "detailcomment", "detailcomment", SAPbobsCOM.BoFieldTypes.db_Alpha, 250)
            oGFun.CreateUserFields(sTableName, "erpno", "erpno", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "divisionno", "divisionno", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "enteredby", "enteredby", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "entereddate", "entereddate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "entrynumber", "entrynumber", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "entrycomment", "entrycomment", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)

        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub

    Sub ListeRaporDeger4() 'Bimsa
        Try
            sTableName = "@ELRAPVB"
            oGFun.CreateTable("ELRAPVB", "Liste Rapor Degerler B", SAPbobsCOM.BoUTBTableType.bott_DocumentLines)

            oGFun.CreateUserFields(sTableName, "startdate", "startdate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "enddate", "enddate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "entryref", "entryref", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "linenumber", "linenumber", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "linenumbercounter", "Yevmiye_Madde_Numarası", SAPbobsCOM.BoFieldTypes.db_Numeric, 8)
            oGFun.CreateUserFields(sTableName, "accmainid", "accmainid", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "accmainiddesc", "accmainiddesc", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "accsubid", "accsubid", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "accsubdesc", "accsubdesc", SAPbobsCOM.BoFieldTypes.db_Alpha, 200)
            oGFun.CreateUserFields(sTableName, "amount", "amount", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "totaldebit", "totaldebit", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "totalcredit", "totalcredit", SAPbobsCOM.BoFieldTypes.db_Float, 0, SAPbobsCOM.BoFldSubTypes.st_Price)
            oGFun.CreateUserFields(sTableName, "debitcreditcode", "debitcreditcode", SAPbobsCOM.BoFieldTypes.db_Alpha, 1)
            oGFun.CreateUserFields(sTableName, "postingdate", "postingdate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "documenttype", "documenttype", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "doctypedesc", "doctypedesc", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "documentnumber", "documentnumber", SAPbobsCOM.BoFieldTypes.db_Alpha, 30)
            oGFun.CreateUserFields(sTableName, "documentreference", "documentreference", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "documentdate", "documentdate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "paymentmethod", "paymentmethod", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)
            oGFun.CreateUserFields(sTableName, "detailcomment", "detailcomment", SAPbobsCOM.BoFieldTypes.db_Alpha, 250)
            oGFun.CreateUserFields(sTableName, "enteredby", "enteredby", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "entereddate", "entereddate", SAPbobsCOM.BoFieldTypes.db_Date)
            oGFun.CreateUserFields(sTableName, "entrynumber", "entrynumber", SAPbobsCOM.BoFieldTypes.db_Alpha, 50)
            oGFun.CreateUserFields(sTableName, "entrycomment", "entrycomment", SAPbobsCOM.BoFieldTypes.db_Alpha, 100)

        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        End Try
    End Sub

    Public Sub CreateEDefterGrid1_HANA()
        Try
            Dim strProcedureText As String = ""

            Dim strPath As String = System.Windows.Forms.Application.StartupPath & "\Script\sp_EDefterGrid1.txt"
            strProcedureText = File.ReadAllText(strPath)

            oGFun.CreateProcedure("SP_EDEFTERGRID1", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        Finally
        End Try
    End Sub

    Public Sub CreateEDefterGrid1()
        Try
            Dim strProcedureText As String = ""
            strProcedureText = strProcedureText + "				CREATE PROCEDURE [dbo].[sp_EDefterGrid1] --1,'2015-01-10' , '2015-03-21','',''																																			" + vbCrLf
            strProcedureText = strProcedureText + "				(																																			" + vbCrLf
            strProcedureText = strProcedureText + "					@DocEntry int,																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	@B1 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	@B2 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	@B3 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	@B4 datetime																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	)																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	AS																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	SET NOCOUNT ON																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @EntryHeaderEnteredBy nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEnteredDate datetime																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryNumber int																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@SatirNo int																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryComment nvarchar(200)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderBatchID smallint																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderBatchDescription nvarchar(200)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderTotalDebit numeric(19,6)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderTotalCredit numeric(19,6)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderDocumentType nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderDocumentTypeDescription nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderDocumentNumber nvarchar(30)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderDocumentDate datetime																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderPaymentMethod nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailAccountAccountMainID nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailAccountAccountMainDescription nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailAccountAccountSubDescription nvarchar(200)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailAccountAccountSubID nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailAmount numeric(19,6)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailDebitCreditCode char(1)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailPostingDate datetime																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@EntryHeaderEntryDetailDetailComment nvarchar(250)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					,@SiralamaTarihi datetime																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @Tarih as smallint																																		" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @strfisnoYeni nvarchar(50),  @strfisno nvarchar(50),  @LineId int, @ObjectId smallint																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "				 	IF @B1='' SET @B1 = '1900-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	IF @B2='' SET @B2 = '2100-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	IF @B3='' SET @B3 = '1900-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	IF @B4='' SET @B4 = '2100-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 	DECLARE @StartDate as datetime, @EndDate as datetime, @SDate nvarchar(8), @EDate nvarchar(8)																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 	IF @B1 <> '1900-01-01' 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 		SET @StartDate = @B1																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 		SET @EndDate = @B2																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 1																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 	END																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	ELSE																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 		SET @StartDate = @B3																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 		SET @EndDate = @B4																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 2																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 	END																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 	DELETE [dbo].[@ELRAPV] WHERE [DocEntry] = @DocEntry	 																																	" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	SET @SDate = CONVERT(VARCHAR(8), @StartDate, 112) 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	SET @EDate = CONVERT(VARCHAR(8), @EndDate, 112) 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				SET @strfisnoYeni = ''																																			" + vbCrLf
            strProcedureText = strProcedureText + "				SET @strfisno = ''																																			" + vbCrLf
            strProcedureText = strProcedureText + "				SET @LineId = 0																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				SELECT @ObjectId =  Series from  [dbo].NNM1 WHERE ObjectCode = 'ELRAP' 																																			" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "				DECLARE @MyCursor CURSOR																																			" + vbCrLf
            strProcedureText = strProcedureText + "				IF (@Tarih=1 )																																			" + vbCrLf
            strProcedureText = strProcedureText + "				BEGIN																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SET @MyCursor = CURSOR FAST_FORWARD	FOR																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT StartDate, EndDate, [EntryHeader.EnteredBy],[EntryHeader.EnteredDate], [EntryHeader.EntryNumber], SatirNo,[EntryHeader.EntryComment],	[EntryHeader.BatchID],[EntryHeader.BatchDescription],[EntryHeader.TotalDebit], [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL([EntryHeader.DocumentType],'') as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN ISNULL([EntryHeader.DocumentType],'')='' THEN '' ELSE [EntryHeader.DocumentTypeDescription] END as [EntryHeader.DocumentTypeDescription], 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN ISNULL([EntryHeader.DocumentType],'')='' THEN '' ELSE [EntryHeader.DocumentNumber] END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN ISNULL([EntryHeader.DocumentType],'')='' THEN '' ELSE [EntryHeader.DocumentDate] END as [EntryHeader.DocumentDate], 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						[EntryHeader.PaymentMethod], [EntryHeader.EntryDetail.Account.AccountMainID], [EntryHeader.EntryDetail.Account.AccountMainDescription],[EntryHeader.EntryDetail.Account.AccountSubDescription],[EntryHeader.EntryDetail.Account.AccountSubID],	 [EntryHeader.EntryDetail.Amount],[EntryHeader.EntryDetail.DebitCreditCode], [EntryHeader.EntryDetail.PostingDate],	[EntryHeader.EntryDetail.DetailComment],SiralamaTarihi FROM																															" + vbCrLf
            strProcedureText = strProcedureText + "						(																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Alinan Çek & Alinan Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentType],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'dekont'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentTypeDescription],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,J.Ref3Line)))<>'' THEN CONVERT(nvarchar,J.Ref3Line)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN CONVERT(nvarchar,R.BoeNum) 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(nvarchar,J.TransID) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), J.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) THEN 'çek'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'banka'--*																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CreditSum IS NOT NULL AND R.CreditSum >0) OR (R.CredSumFC IS NOT NULL AND R.CredSumFC>0)) THEN 'kredi karti'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CashSum IS NOT NULL AND R.CashSum >0) OR (R.CashSumFC IS NOT NULL AND R.CashSumFC>0)) THEN 'nakit'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN 'Senet'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.PaymentMethod],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) AS [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						--J.DebCred as [EntryHeader.EntryDetail.DebitCreditCode],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ORCT](NOLOCK) as R,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND R.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Verilen Çek & Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE K.TransId = O.TransId) > 2 THEN CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE  CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentType],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'dekont'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentTypeDescription],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,J.Ref3Line)))<>'' THEN (SELECT CONVERT(nvarchar, K.Ref3Line) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId AND K.Line_ID = 0) --CONVERT(nvarchar, J.Ref3Line)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN CONVERT(nvarchar,V.BoeNum) 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(nvarchar,J.TransID) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), J.RefDate, 112)  																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) THEN 'çek'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'banka'--*																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CreditSum IS NOT NULL AND V.CreditSum >0) OR (V.CredSumFC IS NOT NULL AND V.CredSumFC>0)) THEN 'kredi karti'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CashSum IS NOT NULL AND V.CashSum >0) OR (V.CashSumFC IS NOT NULL AND V.CashSumFC>0)) THEN 'nakit'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN 'Senet'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.PaymentMethod],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OVPM](NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND V.TransId = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.FolioNum IS NOT NULL AND N.FolioNum>0 THEN CONVERT(nvarchar,N.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(N.U_EFATNO))<>'' THEN CONVERT(nvarchar,N.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OINV](NOLOCK) as N,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 13 --AND N.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 	     																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.FolioNum IS NOT NULL AND P.FolioNum>0 THEN CONVERT(nvarchar,P.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(P.U_EFATNO))<>'' THEN CONVERT(nvarchar,P.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ODPI](NOLOCK) as P,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 203 --AND P.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ORIN](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 14 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 				UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ODPO](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 204 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 				UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OPCH](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 18 --AND I.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 				UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ORPC](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 19 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Istisna Disindakiler*/																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D1'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D2'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D3'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D4'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D5'  THEN 'shipment'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D6'  THEN 'receipt'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentType],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D1'  THEN 'masraf formu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D2'  THEN 'Z Raporu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D5'  THEN 'Navlum'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D6'  THEN 'Makbuz'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentTypeDescription],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.FolioNum IS NOT NULL THEN CONVERT(nvarchar,O.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.RefDate BETWEEN @B1 AND @B2																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			) AS A  WHERE [EntryHeader.EntryDetail.Amount]>0 	ORDER BY SiralamaTarihi, [EntryHeader.EntryNumber], SatirNo																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				END																																			" + vbCrLf
            strProcedureText = strProcedureText + "				ELSE																																			" + vbCrLf
            strProcedureText = strProcedureText + "				BEGIN																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SET @MyCursor = CURSOR FAST_FORWARD	FOR																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT StartDate, EndDate, [EntryHeader.EnteredBy],[EntryHeader.EnteredDate], [EntryHeader.EntryNumber], SatirNo,[EntryHeader.EntryComment],	[EntryHeader.BatchID],[EntryHeader.BatchDescription],[EntryHeader.TotalDebit], [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL([EntryHeader.DocumentType],'') as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN ISNULL([EntryHeader.DocumentType],'')='' THEN '' ELSE [EntryHeader.DocumentTypeDescription] END as [EntryHeader.DocumentTypeDescription], 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN ISNULL([EntryHeader.DocumentType],'')='' THEN '' ELSE [EntryHeader.DocumentNumber] END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN ISNULL([EntryHeader.DocumentType],'')='' THEN '' ELSE [EntryHeader.DocumentDate] END as [EntryHeader.DocumentDate], 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						[EntryHeader.PaymentMethod], [EntryHeader.EntryDetail.Account.AccountMainID], [EntryHeader.EntryDetail.Account.AccountMainDescription],[EntryHeader.EntryDetail.Account.AccountSubDescription],[EntryHeader.EntryDetail.Account.AccountSubID],	 [EntryHeader.EntryDetail.Amount],[EntryHeader.EntryDetail.DebitCreditCode], [EntryHeader.EntryDetail.PostingDate],	[EntryHeader.EntryDetail.DetailComment],SiralamaTarihi FROM																															" + vbCrLf
            strProcedureText = strProcedureText + "						(																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Alinan Çek & Alinan Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentType],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'dekont'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentTypeDescription],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,J.Ref3Line)))<>'' THEN CONVERT(nvarchar,J.Ref3Line)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN CONVERT(nvarchar,R.BoeNum) 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(nvarchar,J.TransID) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), J.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN R.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) THEN 'çek'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'banka'--*																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CreditSum IS NOT NULL AND R.CreditSum >0) OR (R.CredSumFC IS NOT NULL AND R.CredSumFC>0)) THEN 'kredi karti'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.CashSum IS NOT NULL AND R.CashSum >0) OR (R.CashSumFC IS NOT NULL AND R.CashSumFC>0)) THEN 'nakit'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN 'Senet'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.PaymentMethod],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) AS [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						--J.DebCred as [EntryHeader.EntryDetail.DebitCreditCode],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ORCT](NOLOCK) as R,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND R.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Verilen Çek & Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE K.TransId = O.TransId) > 2 THEN CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE  CONVERT(NVARCHAR,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentType],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'dekont'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentTypeDescription],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,J.Ref3Line)))<>'' THEN (SELECT CONVERT(nvarchar, K.Ref3Line) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId AND K.Line_ID = 0) --CONVERT(nvarchar, J.Ref3Line)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN CONVERT(nvarchar,V.BoeNum) 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(nvarchar,J.TransID) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), J.RefDate, 112)  																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN V.Canceled <> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) THEN 'çek'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'banka'--*																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CreditSum IS NOT NULL AND V.CreditSum >0) OR (V.CredSumFC IS NOT NULL AND V.CredSumFC>0)) THEN 'kredi karti'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.CashSum IS NOT NULL AND V.CashSum >0) OR (V.CashSumFC IS NOT NULL AND V.CashSumFC>0)) THEN 'nakit'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN 'Senet'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.PaymentMethod],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OVPM](NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND V.TransId = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112) as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.FolioNum IS NOT NULL AND N.FolioNum>0 THEN CONVERT(nvarchar,N.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(N.U_EFATNO))<>'' THEN CONVERT(nvarchar,N.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN N.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OINV](NOLOCK) as N,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 13 --AND N.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 	     																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 	 																																		" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.FolioNum IS NOT NULL AND P.FolioNum>0 THEN CONVERT(nvarchar,P.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(P.U_EFATNO))<>'' THEN CONVERT(nvarchar,P.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN P.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ODPI](NOLOCK) as P,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 203 --AND P.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ORIN](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 14 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 				UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N'THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ODPO](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 204 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 				UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate, 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OPCH](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 18 --AND I.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 				UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentType],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentTypeDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN '' 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar,I.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar,I.U_EFATNO)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE ''																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN I.Canceled<> 'N' THEN ''																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[ORPC](NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TransType = 19 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			/*Istisna Disindakiler*/																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "						@SDate as StartDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						@EDate as EndDate,																																	" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as [EntryHeader.EnteredBy],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EnteredDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR,O.TransId) as [EntryHeader.EntryNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo,																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as [EntryHeader.EntryComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.BatchDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalDebit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as [EntryHeader.TotalCredit],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D1'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D2'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D3'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D4'  THEN 'other'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D5'  THEN 'shipment'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D6'  THEN 'receipt'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTip,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentType],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D1'  THEN 'masraf formu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D2'  THEN 'Z Raporu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D5'  THEN 'Navlum'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.Indicator = 'D6'  THEN 'Makbuz'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE (SELECT ISNULL(U_BelTipTanim,'') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.DocumentTypeDescription],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN O.FolioNum IS NOT NULL THEN CONVERT(nvarchar,O.FolioNum)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			ELSE CONVERT(nvarchar,O.TransId)																																" + vbCrLf
            strProcedureText = strProcedureText + "						END as [EntryHeader.DocumentNumber],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.DocumentDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						'' as [EntryHeader.PaymentMethod],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account,1,3) as [EntryHeader.EntryDetail.Account.AccountMainID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as [EntryHeader.EntryDetail.Account.AccountMainDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as [EntryHeader.EntryDetail.Account.AccountSubDescription],																																	" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as [EntryHeader.EntryDetail.Account.AccountSubID],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.Amount],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'																																" + vbCrLf
            strProcedureText = strProcedureText + "						END	as [EntryHeader.EntryDetail.DebitCreditCode],																																" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8), O.RefDate, 112)  as  [EntryHeader.EntryDetail.PostingDate],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as [EntryHeader.EntryDetail.DetailComment],																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi																																	" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				 			FROM [dbo].[OJDT](NOLOCK) as O, [dbo].[JDT1](NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			[dbo].[OUSR](NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			WHERE J.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "				 			) AS A  WHERE [EntryHeader.EntryDetail.Amount]>0 	ORDER BY SiralamaTarihi, [EntryHeader.EntryNumber], SatirNo																															" + vbCrLf
            strProcedureText = strProcedureText + "				 																																			" + vbCrLf
            strProcedureText = strProcedureText + "				END																																			" + vbCrLf
            strProcedureText = strProcedureText + "		 																																					" + vbCrLf
            strProcedureText = strProcedureText + "				OPEN @MyCursor																																			" + vbCrLf
            strProcedureText = strProcedureText + "				FETCH NEXT FROM @MyCursor INTO 	@StartDate,  @EndDate, @EntryHeaderEnteredBy,@EntryHeaderEnteredDate, @EntryHeaderEntryNumber, @SatirNo, @EntryHeaderEntryComment,	@EntryHeaderBatchID,@EntryHeaderBatchDescription,@EntryHeaderTotalDebit, @EntryHeaderTotalCredit,	@EntryHeaderDocumentType,@EntryHeaderDocumentTypeDescription, @EntryHeaderDocumentNumber,	@EntryHeaderDocumentDate, @EntryHeaderPaymentMethod, @EntryHeaderEntryDetailAccountAccountMainID, @EntryHeaderEntryDetailAccountAccountMainDescription,@EntryHeaderEntryDetailAccountAccountSubDescription,@EntryHeaderEntryDetailAccountAccountSubID,	 @EntryHeaderEntryDetailAmount,@EntryHeaderEntryDetailDebitCreditCode, @EntryHeaderEntryDetailPostingDate,	@EntryHeaderEntryDetailDetailComment, @SiralamaTarihi																													" + vbCrLf
            strProcedureText = strProcedureText + "				WHILE @@FETCH_STATUS = 0																																			" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "						SET @strfisnoYeni = @EntryHeaderEntryNumber																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "						If @strfisno = @strfisnoYeni 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						BEGIN																																	" + vbCrLf
            strProcedureText = strProcedureText + "							SET @LineId = @LineId + 1																																" + vbCrLf
            strProcedureText = strProcedureText + "						END																																	" + vbCrLf
            strProcedureText = strProcedureText + "						ELSE 																																	" + vbCrLf
            strProcedureText = strProcedureText + "						BEGIN																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SET @LineId = @LineId + 1																																" + vbCrLf
            strProcedureText = strProcedureText + "							SET @strfisno = @strfisnoYeni																																" + vbCrLf
            strProcedureText = strProcedureText + "						END																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "						IF @EntryHeaderDocumentDate = '1900-01-01'																																	" + vbCrLf
            strProcedureText = strProcedureText + "							INSERT INTO [dbo].[@ELRAPV]([DocEntry],[LineId],[VisOrder],[Object],[LogInst],[U_StartDate],[U_EndDate],[U_EnteredBy],[U_EnteredDate],[U_EntryNumber],[U_EntryComment],[U_BatchID],[U_BatchDescription],[U_TotalDebit],[U_TotalCredit],[U_DocumentType],[U_DocTypeDesc],[U_DocumentNumber],[U_DocumentDate],[U_PaymentMethod],[U_AccountMainID],[U_AccMainDesc],[U_AccSubDesc],[U_AccountSubID],[U_Amount],[U_DebitCreditCode],[U_PostingDate],[U_DetailComment])																																" + vbCrLf
            strProcedureText = strProcedureText + "								VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL,  @StartDate, @EndDate, @EntryHeaderEnteredBy,@EntryHeaderEnteredDate, @EntryHeaderEntryNumber, @EntryHeaderEntryComment,	@EntryHeaderBatchID,@EntryHeaderBatchDescription,@EntryHeaderTotalDebit, @EntryHeaderTotalCredit, @EntryHeaderDocumentType,@EntryHeaderDocumentTypeDescription, @EntryHeaderDocumentNumber,	NULL, @EntryHeaderPaymentMethod, @EntryHeaderEntryDetailAccountAccountMainID, @EntryHeaderEntryDetailAccountAccountMainDescription,@EntryHeaderEntryDetailAccountAccountSubDescription,@EntryHeaderEntryDetailAccountAccountSubID,	 @EntryHeaderEntryDetailAmount,@EntryHeaderEntryDetailDebitCreditCode, @EntryHeaderEntryDetailPostingDate,	@EntryHeaderEntryDetailDetailComment)																											" + vbCrLf
            strProcedureText = strProcedureText + "						ELSE																																	" + vbCrLf
            strProcedureText = strProcedureText + "							INSERT INTO [dbo].[@ELRAPV]([DocEntry],[LineId],[VisOrder],[Object],[LogInst],[U_StartDate],[U_EndDate],[U_EnteredBy],[U_EnteredDate], [U_EntryNumber], [U_EntryComment], [U_BatchID], [U_BatchDescription], [U_TotalDebit],  [U_TotalCredit], [U_DocumentType], [U_DocTypeDesc], [U_DocumentNumber], [U_DocumentDate], [U_PaymentMethod], [U_AccountMainID], [U_AccMainDesc], [U_AccSubDesc], [U_AccountSubID], [U_Amount],[U_DebitCreditCode],[U_PostingDate],[U_DetailComment])																																" + vbCrLf
            strProcedureText = strProcedureText + "								VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL,  @StartDate, @EndDate, @EntryHeaderEnteredBy,@EntryHeaderEnteredDate, @EntryHeaderEntryNumber, @EntryHeaderEntryComment,	@EntryHeaderBatchID,@EntryHeaderBatchDescription,@EntryHeaderTotalDebit, @EntryHeaderTotalCredit, @EntryHeaderDocumentType,@EntryHeaderDocumentTypeDescription, @EntryHeaderDocumentNumber,	@EntryHeaderDocumentDate, @EntryHeaderPaymentMethod, @EntryHeaderEntryDetailAccountAccountMainID, @EntryHeaderEntryDetailAccountAccountMainDescription,@EntryHeaderEntryDetailAccountAccountSubDescription,@EntryHeaderEntryDetailAccountAccountSubID,	 @EntryHeaderEntryDetailAmount,@EntryHeaderEntryDetailDebitCreditCode, @EntryHeaderEntryDetailPostingDate,	@EntryHeaderEntryDetailDetailComment)																											" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "						FETCH NEXT FROM @MyCursor																																	" + vbCrLf
            strProcedureText = strProcedureText + "						INTO @StartDate,  @EndDate, @EntryHeaderEnteredBy,@EntryHeaderEnteredDate, @EntryHeaderEntryNumber, @SatirNo, @EntryHeaderEntryComment,	@EntryHeaderBatchID,@EntryHeaderBatchDescription,@EntryHeaderTotalDebit, @EntryHeaderTotalCredit,	@EntryHeaderDocumentType,@EntryHeaderDocumentTypeDescription, @EntryHeaderDocumentNumber,	@EntryHeaderDocumentDate, @EntryHeaderPaymentMethod, @EntryHeaderEntryDetailAccountAccountMainID, @EntryHeaderEntryDetailAccountAccountMainDescription,@EntryHeaderEntryDetailAccountAccountSubDescription,@EntryHeaderEntryDetailAccountAccountSubID,	 @EntryHeaderEntryDetailAmount,@EntryHeaderEntryDetailDebitCreditCode, @EntryHeaderEntryDetailPostingDate,	@EntryHeaderEntryDetailDetailComment, @SiralamaTarihi																												" + vbCrLf
            strProcedureText = strProcedureText + "					END																																		" + vbCrLf
            strProcedureText = strProcedureText + "				CLOSE @MyCursor																																			" + vbCrLf
            strProcedureText = strProcedureText + "				DEALLOCATE @MyCursor																																			" + vbCrLf


            oGFun.CreateProcedure("sp_EDefterGrid1", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        Finally
        End Try
    End Sub

    Public Sub CreateEDefterExcel1()
        Try
            Dim strProcedureText As String = ""
           
                strProcedureText = strProcedureText + "	CREATE PROCEDURE [dbo].[sp_EDefterExcel1] --'2015-02-01','2015-02-18','',''				" + vbCrLf
                strProcedureText = strProcedureText + "	    (		" + vbCrLf
                strProcedureText = strProcedureText + "		 @DocEntry int 	" + vbCrLf
                strProcedureText = strProcedureText + "		 )	" + vbCrLf
                strProcedureText = strProcedureText + "		 AS	" + vbCrLf
                strProcedureText = strProcedureText + "		 	" + vbCrLf
                strProcedureText = strProcedureText + "		 SELECT CONVERT(VARCHAR(10), [U_StartDate], 120) as StartDate	" + vbCrLf
                strProcedureText = strProcedureText + "	      ,CONVERT(VARCHAR(10), [U_EndDate], 120) as EndDate		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_EnteredBy] as [EntryHeader.EnteredBy]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,CONVERT(VARCHAR(10), [U_EnteredDate], 120) as [EntryHeader.EnteredDate]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_EntryNumber] as [EntryHeader.EntryNumber]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_EntryComment] as [EntryHeader.EntryComment]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,ISNULL([U_BatchID],'') as [EntryHeader.BatchID]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_BatchDescription] as [EntryHeader.BatchDescription]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_TotalDebit] as [EntryHeader.TotalDebit]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_TotalCredit] as [EntryHeader.TotalCredit]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_DocumentType] as [EntryHeader.DocumentType]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,ISNULL([U_DocTypeDesc],'') as [EntryHeader.DocumentTypeDescription]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,ISNULL([U_DocumentNumber],'') as [EntryHeader.DocumentNumber]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,CONVERT(VARCHAR(10), [U_DocumentDate] , 120) as [EntryHeader.DocumentDate]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,ISNULL([U_PaymentMethod],'') as [EntryHeader.PaymentMethod]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_AccountMainID] as [EntryHeader.EntryDetail.Account.AccountMainID]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_AccMainDesc] as [EntryHeader.EntryDetail.Account.AccountMainDescription]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_AccSubDesc] as [EntryHeader.EntryDetail.Account.AccountSubDescription]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_AccountSubID] as [EntryHeader.EntryDetail.Account.AccountSubID]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_Amount] as [EntryHeader.EntryDetail.Amount] 		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_DebitCreditCode] as [EntryHeader.EntryDetail.DebitCreditCode]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,CONVERT(VARCHAR(10), [U_PostingDate], 120) as [EntryHeader.EntryDetail.PostingDate]		" + vbCrLf
                strProcedureText = strProcedureText + "	      ,[U_DetailComment] as [EntryHeader.EntryDetail.DetailComment]		" + vbCrLf
                strProcedureText = strProcedureText + "	  FROM [dbo].[@ELRAPV](NOLOCK) 		" + vbCrLf
                strProcedureText = strProcedureText + "	  WHERE DocEntry = @DocEntry 		" + vbCrLf
                strProcedureText = strProcedureText + "	  AND [U_Amount]>0		" + vbCrLf
                strProcedureText = strProcedureText + "	  ORDER BY [U_DocumentDate]		" + vbCrLf

            oGFun.CreateProcedure("sp_EDefterExcel1", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        Finally
        End Try
    End Sub

    Public Sub CreateEDefterExcel1_HANA()
        Try
            Dim strProcedureText As String = ""

            Dim strPath As String = System.Windows.Forms.Application.StartupPath & "\Script\sp_EDefterExcel1.txt"
            strProcedureText = File.ReadAllText(strPath)

            oGFun.CreateProcedure("SP_EDEFTEREXCEL1", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)
        Finally
        End Try
    End Sub

    Public Sub CreateEDefterGrid2()
        Try
            Dim strProcedureText As String = ""
            strProcedureText = strProcedureText + "				CREATE PROCEDURE [dbo].[sp_EDefterGrid2] --'20150106' , '20150115', '','', 1,1,1																																			" + vbCrLf
            strProcedureText = strProcedureText + "					(																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B1 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B2 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B3 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B4 datetime,																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @DocEntry int,																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @Yevmiye_Madde_Numarasi int,																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @Satir_Madde_No int																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 )																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 AS																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET NOCOUNT ON																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B1='' SET @B1 = '1900-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B2='' SET @B2 = '2100-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B3='' SET @B3 = '1900-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B4='' SET @B4 = '2100-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Tarih as smallint																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @StartDate as datetime, @EndDate as datetime, @SDate nvarchar(8), @EDate nvarchar(8)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Fisi_Kaydeden nvarchar(50), @Yevmiye_Tarihi datetime, @Fis_Numarasi nvarchar(50), @Fis_Satir_No nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Kayit_Aciklamasi nvarchar(250), @Toplam_Borc numeric(19,6), @Toplam_Alacak numeric(19,6)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Firma_No nvarchar(50), @Sube_No nvarchar(50), @Kaynak_Referansi nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Dokuman_Tipi nvarchar(100), @Dokuman_Tipi_Aciklamasi nvarchar(100), @Dokuman_No nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Dokuman_Tarihi datetime, @Odeme_Yontemi nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Ana_Hesap_Kodu nvarchar(100), @Ana_Hesap_Aciklamasi nvarchar(200), @Alt_Hesap_Kodu nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Alt_Hesap_Aciklamasi nvarchar(100),@Borc numeric(19,6),@Alacak numeric(19,6), @Fis_Detay_Aciklamasi nvarchar(250)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @strfisnoYeni nvarchar(50), @strfisno nvarchar(50), @intsatirMaddeNo int, @LineId int																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @ObjectId smallint																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B1 <> '1900-01-01' 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SET @StartDate = @B1																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @EndDate = @B2																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 1																																	" + vbCrLf
            strProcedureText = strProcedureText + "					 END																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 ELSE																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SET @StartDate = @B3																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @EndDate = @B4																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 2																																	" + vbCrLf
            strProcedureText = strProcedureText + "					 END																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @SDate = CONVERT(VARCHAR(8), @StartDate, 112) 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @EDate = CONVERT(VARCHAR(8), @EndDate, 112) 																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 DELETE [dbo].[@ELRAPVH] WHERE [DocEntry] = @DocEntry																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @Yevmiye_Madde_Numarasi = 0 																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT @Yevmiye_Madde_Numarasi = ISNULL(MAX([U_Yevmiye_Madde_No]),0)+1 from [dbo].[@ELRAPVH](NOLOCK)  WHERE Datepart(YYYY,getdate()) = Datepart(YYYY,[U_Yevmiye_Tarihi])																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @Satir_Madde_No = 0																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT @Satir_Madde_No = ISNULL(MAX(U_Satir_Madde_No),0) + 1 from [dbo].[@ELRAPVH](NOLOCK) WHERE [U_Yevmiye_Tarihi] = (@Yevmiye_Madde_Numarasi -1)																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "						SET @intsatirMaddeNo = @Satir_Madde_No -1																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi -1																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @strfisnoYeni = ''																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @strfisno = ''																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @LineId = 0																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SELECT @ObjectId =  Series from  [dbo].NNM1 WHERE ObjectCode = 'ELRAP' 																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @MyCursor CURSOR																																		" + vbCrLf
            strProcedureText = strProcedureText + "					IF (@Tarih=1 )																																		" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "							SET @MyCursor = CURSOR FAST_FORWARD	FOR																															" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT Fisi_Kaydeden,Yevmiye_Tarihi,Fis_Numarasi,Fis_Satir_No,Kayit_Aciklamasi, ISNULL(Toplam_Borc,0), ISNULL(Toplam_Alacak,0), Firma_No,Sube_No,Kaynak_Referansi,Dokuman_Tipi,Dokuman_Tipi_Aciklamasi,Dokuman_No,Dokuman_Tarihi,Odeme_Yontemi,Satir_Madde_No,Ana_Hesap_Kodu,Ana_Hesap_Aciklamasi,Alt_Hesap_Kodu,Alt_Hesap_Aciklamasi,ISNULL(Borc,0), ISNULL(Alacak,0), Fis_Detay_Aciklamasi FROM																																" + vbCrLf
            strProcedureText = strProcedureText + "							(																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Alinan Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'check' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Çek bordrosu'	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'çek'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHH_Log(NOLOCK) as R,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (R.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,R.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Alinan Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'senet'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OBOE_Log(NOLOCK) as R, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND R.CheckNo IS NOT NULL AND R.CheckNo >0																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,V.CheckNo) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHO_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OVPM(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND T.TransId = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,V.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OUTBOE_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							/*Alinan Senet Kontrolleri sss*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'other' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'dekont' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'banka'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORCT(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId  AND U.USERID = O.UserSign AND T.TransId = O.TransId 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OCHH_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OBOE_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2  																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							  UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN N.Canceled='N' AND O.FolioNum IS NOT NULL AND CONVERT(nvarchar,O.FolioNum)<>'' THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled='N' AND N.U_EFATNO  IS NOT NULL AND CONVERT(nvarchar,N.U_EFATNO)<>'' THEN CONVERT(nvarchar,N.U_EFATNO)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OINV(NOLOCK) as N,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 13 --AND N.Canceled='N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					     																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPI(NOLOCK) as P,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 203 --AND P.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORIN(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 14 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPO(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 204 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OPCH(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 18 --AND I.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN  NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORPC(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 19 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Istisna Disindakiler*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'shipment'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'receipt'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'masraf formu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'Z Raporu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'Navlum'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'Makbuz'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112)  																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 ) AS A  WHERE Borc>0 OR Alacak>0 ORDER BY  SiralamaTarihi,Fis_Numarasi--, Fiş_Numarası																																" + vbCrLf
            strProcedureText = strProcedureText + "					END																																		" + vbCrLf
            strProcedureText = strProcedureText + "					ELSE																																		" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "							SET @MyCursor = CURSOR FAST_FORWARD	FOR																															" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT Fisi_Kaydeden,Yevmiye_Tarihi,Fis_Numarasi,Fis_Satir_No,Kayit_Aciklamasi, ISNULL(Toplam_Borc,0), ISNULL(Toplam_Alacak,0), Firma_No,Sube_No,Kaynak_Referansi,Dokuman_Tipi,Dokuman_Tipi_Aciklamasi,Dokuman_No,Dokuman_Tarihi,Odeme_Yontemi,Satir_Madde_No,Ana_Hesap_Kodu,Ana_Hesap_Aciklamasi,Alt_Hesap_Kodu,Alt_Hesap_Aciklamasi,ISNULL(Borc,0), ISNULL(Alacak,0), Fis_Detay_Aciklamasi FROM																																" + vbCrLf
            strProcedureText = strProcedureText + "							(																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Alinan Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'check' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Çek bordrosu'	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'çek'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHH_Log(NOLOCK) as R,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (R.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,R.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Alinan Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'senet'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OBOE_Log(NOLOCK) as R, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND R.CheckNo IS NOT NULL AND R.CheckNo >0																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,V.CheckNo) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHO_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OVPM(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND T.TransId = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,V.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OUTBOE_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							/*Alinan Senet Kontrolleri sss*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'other' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'dekont' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'banka'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORCT(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId  AND U.USERID = O.UserSign AND T.TransId = O.TransId 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OCHH_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OBOE_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4 																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							  UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN N.Canceled='N' AND O.FolioNum IS NOT NULL AND CONVERT(nvarchar,O.FolioNum)<>'' THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled='N' AND N.U_EFATNO  IS NOT NULL AND CONVERT(nvarchar,N.U_EFATNO)<>'' THEN CONVERT(nvarchar,N.U_EFATNO)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OINV(NOLOCK) as N,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 13 --AND N.Canceled='N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					     																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPI(NOLOCK) as P,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 203 --AND P.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							  AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORIN(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 14 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPO(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 204 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OPCH(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 18 --AND I.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN  NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORPC(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 19 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Istisna Disindakiler*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'shipment'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'receipt'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'masraf formu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'Z Raporu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'Navlum'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'Makbuz'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112)  																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 ) AS A  WHERE Borc>0 OR Alacak>0 ORDER BY  SiralamaTarihi,Fis_Numarasi--, Fiş_Numarası																																" + vbCrLf
            strProcedureText = strProcedureText + "					END																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					OPEN @MyCursor																																		" + vbCrLf
            strProcedureText = strProcedureText + "					FETCH NEXT FROM @MyCursor INTO @Fisi_Kaydeden,@Yevmiye_Tarihi,@Fis_Numarasi,@Fis_Satir_No,@Kayit_Aciklamasi,@Toplam_Borc,@Toplam_Alacak,@Firma_No,@Sube_No,@Kaynak_Referansi,@Dokuman_Tipi,@Dokuman_Tipi_Aciklamasi,@Dokuman_No,@Dokuman_Tarihi,@Odeme_Yontemi,@Satir_Madde_No,@Ana_Hesap_Kodu,@Ana_Hesap_Aciklamasi,@Alt_Hesap_Kodu,@Alt_Hesap_Aciklamasi,@Borc,@Alacak,@Fis_Detay_Aciklamasi																																		" + vbCrLf
            strProcedureText = strProcedureText + "					WHILE @@FETCH_STATUS = 0																																		" + vbCrLf
            strProcedureText = strProcedureText + "						BEGIN																																	" + vbCrLf
            strProcedureText = strProcedureText + "							--@Yevmiye_Madde_Numarasi																																" + vbCrLf
            strProcedureText = strProcedureText + "							SET @intsatirMaddeNo = @intsatirMaddeNo +1																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SET @strfisnoYeni = @Fis_Numarasi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					        If @strfisno = @strfisnoYeni 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							BEGIN																																" + vbCrLf
            strProcedureText = strProcedureText + "								SET @LineId = @LineId + 1																															" + vbCrLf
            strProcedureText = strProcedureText + "							END																																" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE --@strfisno <> @strfisnoYeni 																																" + vbCrLf
            strProcedureText = strProcedureText + "							BEGIN																																" + vbCrLf
            strProcedureText = strProcedureText + "					            --SET @intsatirMaddeNo = 1																																		" + vbCrLf
            strProcedureText = strProcedureText + "								SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi + 1																															" + vbCrLf
            strProcedureText = strProcedureText + "								SET @LineId = @LineId + 1																															" + vbCrLf
            strProcedureText = strProcedureText + "					            SET @strfisno = @strfisnoYeni																																		" + vbCrLf
            strProcedureText = strProcedureText + "					        END																																		" + vbCrLf
            strProcedureText = strProcedureText + "							--@ObjectId																																" + vbCrLf
            strProcedureText = strProcedureText + "							--SET @LineId = @LineId + 1																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							IF @Dokuman_Tarihi = '1900-01-01 00:00:00.000'																																" + vbCrLf
            strProcedureText = strProcedureText + "								INSERT INTO [dbo].[@ELRAPVH]([DocEntry],[LineId],[VisOrder],[Object],[LogInst],[U_Yevmiye_Madde_No],[U_Fis_Numarasi],[U_Fis_Satir_No],[U_Yevmiye_Tarihi],[U_Fisi_Kaydeden],[U_Kayit_Acik],[U_Toplam_Borc],[U_Toplam_Alacak],[U_Satir_Madde_No],[U_Ana_Hesap_Kodu],[U_Ana_Hesap_Acik],[U_Alt_Hesap_Kodu],[U_Alt_Hesap_Acik],[U_Borc],[U_Alacak],[U_Dokuman_No],[U_Dokuman_Tipi],[U_Dokuman_Tipi_Acik],[U_Dokuman_Tarihi],[U_Odeme_Yontemi],[U_Fis_Detay_Acik],[U_Firma_No],[U_Sube_No],[U_Kaynak_Referansi])																															" + vbCrLf
            strProcedureText = strProcedureText + "									VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @Yevmiye_Madde_Numarasi, @Fis_Numarasi, @Fis_Satir_No + 1, @Yevmiye_Tarihi, @Fisi_Kaydeden, @Kayit_Aciklamasi, @Toplam_Borc, @Toplam_Alacak, @intsatirMaddeNo, @Ana_Hesap_Kodu, @Ana_Hesap_Aciklamasi, @Alt_Hesap_Kodu, @Alt_Hesap_Aciklamasi, @Borc, @Alacak, @Dokuman_No, @Dokuman_Tipi, @Dokuman_Tipi_Aciklamasi, NULL, @Odeme_Yontemi, @Fis_Detay_Aciklamasi, @Firma_No, @Sube_No, @Kaynak_Referansi)																														" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE																																" + vbCrLf
            strProcedureText = strProcedureText + "								INSERT INTO [dbo].[@ELRAPVH]([DocEntry],[LineId],[VisOrder],[Object],[LogInst],[U_Yevmiye_Madde_No],[U_Fis_Numarasi],[U_Fis_Satir_No],[U_Yevmiye_Tarihi],[U_Fisi_Kaydeden],[U_Kayit_Acik],[U_Toplam_Borc],[U_Toplam_Alacak],[U_Satir_Madde_No],[U_Ana_Hesap_Kodu],[U_Ana_Hesap_Acik],[U_Alt_Hesap_Kodu],[U_Alt_Hesap_Acik],[U_Borc],[U_Alacak],[U_Dokuman_No],[U_Dokuman_Tipi],[U_Dokuman_Tipi_Acik],[U_Dokuman_Tarihi],[U_Odeme_Yontemi],[U_Fis_Detay_Acik],[U_Firma_No],[U_Sube_No],[U_Kaynak_Referansi])																															" + vbCrLf
            strProcedureText = strProcedureText + "									VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @Yevmiye_Madde_Numarasi, @Fis_Numarasi, @Fis_Satir_No + 1, @Yevmiye_Tarihi, @Fisi_Kaydeden, @Kayit_Aciklamasi, @Toplam_Borc, @Toplam_Alacak, @intsatirMaddeNo, @Ana_Hesap_Kodu, @Ana_Hesap_Aciklamasi, @Alt_Hesap_Kodu, @Alt_Hesap_Aciklamasi, @Borc, @Alacak, @Dokuman_No, @Dokuman_Tipi, @Dokuman_Tipi_Aciklamasi, @Dokuman_Tarihi, @Odeme_Yontemi, @Fis_Detay_Aciklamasi, @Firma_No, @Sube_No, @Kaynak_Referansi)																														" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							--SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi + 1																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							FETCH NEXT FROM @MyCursor																																" + vbCrLf
            strProcedureText = strProcedureText + "							INTO @Fisi_Kaydeden,@Yevmiye_Tarihi,@Fis_Numarasi,@Fis_Satir_No,@Kayit_Aciklamasi,@Toplam_Borc,@Toplam_Alacak,@Firma_No,@Sube_No,@Kaynak_Referansi,@Dokuman_Tipi,@Dokuman_Tipi_Aciklamasi,@Dokuman_No,@Dokuman_Tarihi,@Odeme_Yontemi,@Satir_Madde_No,@Ana_Hesap_Kodu,@Ana_Hesap_Aciklamasi,@Alt_Hesap_Kodu,@Alt_Hesap_Aciklamasi,@Borc,@Alacak,@Fis_Detay_Aciklamasi																																" + vbCrLf
            strProcedureText = strProcedureText + "						END																																	" + vbCrLf
            strProcedureText = strProcedureText + "					CLOSE @MyCursor																																		" + vbCrLf
            strProcedureText = strProcedureText + "					DEALLOCATE @MyCursor																																		" + vbCrLf


            oGFun.CreateProcedure("sp_EDefterGrid2", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
    Public Sub CreateEDefterGrid2_HANA()
        Try
            Dim strProcedureText As String = ""
            strProcedureText = strProcedureText + "				CREATE PROCEDURE [dbo].[sp_EDefterGrid2] --'20150106' , '20150115', '','', 1,1,1																																			" + vbCrLf
            strProcedureText = strProcedureText + "					(																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B1 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B2 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B3 datetime, 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @B4 datetime,																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @DocEntry int,																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @Yevmiye_Madde_Numarasi int,																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 @Satir_Madde_No int																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 )																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 AS																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET NOCOUNT ON																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B1='' SET @B1 = '1900-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B2='' SET @B2 = '2100-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B3='' SET @B3 = '1900-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B4='' SET @B4 = '2100-01-01'																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Tarih as smallint																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @StartDate as datetime, @EndDate as datetime, @SDate nvarchar(8), @EDate nvarchar(8)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Fisi_Kaydeden nvarchar(50), @Yevmiye_Tarihi datetime, @Fis_Numarasi nvarchar(50), @Fis_Satir_No nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Kayit_Aciklamasi nvarchar(250), @Toplam_Borc numeric(19,6), @Toplam_Alacak numeric(19,6)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Firma_No nvarchar(50), @Sube_No nvarchar(50), @Kaynak_Referansi nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Dokuman_Tipi nvarchar(100), @Dokuman_Tipi_Aciklamasi nvarchar(100), @Dokuman_No nvarchar(50)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Dokuman_Tarihi datetime, @Odeme_Yontemi nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Ana_Hesap_Kodu nvarchar(100), @Ana_Hesap_Aciklamasi nvarchar(200), @Alt_Hesap_Kodu nvarchar(100)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @Alt_Hesap_Aciklamasi nvarchar(100),@Borc numeric(19,6),@Alacak numeric(19,6), @Fis_Detay_Aciklamasi nvarchar(250)																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @strfisnoYeni nvarchar(50), @strfisno nvarchar(50), @intsatirMaddeNo int, @LineId int																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 DECLARE @ObjectId smallint																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @B1 <> '1900-01-01' 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SET @StartDate = @B1																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @EndDate = @B2																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 1																																	" + vbCrLf
            strProcedureText = strProcedureText + "					 END																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 ELSE																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SET @StartDate = @B3																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @EndDate = @B4																																	" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 2																																	" + vbCrLf
            strProcedureText = strProcedureText + "					 END																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @SDate = CONVERT(VARCHAR(8), @StartDate, 112) 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @EDate = CONVERT(VARCHAR(8), @EndDate, 112) 																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 DELETE [dbo].[@ELRAPVH] WHERE [DocEntry] = @DocEntry																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @Yevmiye_Madde_Numarasi = 0 																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT @Yevmiye_Madde_Numarasi = ISNULL(MAX([U_Yevmiye_Madde_No]),0)+1 from [dbo].[@ELRAPVH](NOLOCK)  WHERE Datepart(YYYY,getdate()) = Datepart(YYYY,[U_Yevmiye_Tarihi])																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 IF @Satir_Madde_No = 0																																		" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT @Satir_Madde_No = ISNULL(MAX(U_Satir_Madde_No),0) + 1 from [dbo].[@ELRAPVH](NOLOCK) WHERE [U_Yevmiye_Tarihi] = (@Yevmiye_Madde_Numarasi -1)																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "						SET @intsatirMaddeNo = @Satir_Madde_No -1																																	" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi -1																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @strfisnoYeni = ''																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @strfisno = ''																																		" + vbCrLf
            strProcedureText = strProcedureText + "					 SET @LineId = 0																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 SELECT @ObjectId =  Series from  [dbo].NNM1 WHERE ObjectCode = 'ELRAP' 																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @MyCursor CURSOR																																		" + vbCrLf
            strProcedureText = strProcedureText + "					IF (@Tarih=1 )																																		" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "							SET @MyCursor = CURSOR FAST_FORWARD	FOR																															" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT Fisi_Kaydeden,Yevmiye_Tarihi,Fis_Numarasi,Fis_Satir_No,Kayit_Aciklamasi, ISNULL(Toplam_Borc,0), ISNULL(Toplam_Alacak,0), Firma_No,Sube_No,Kaynak_Referansi,Dokuman_Tipi,Dokuman_Tipi_Aciklamasi,Dokuman_No,Dokuman_Tarihi,Odeme_Yontemi,Satir_Madde_No,Ana_Hesap_Kodu,Ana_Hesap_Aciklamasi,Alt_Hesap_Kodu,Alt_Hesap_Aciklamasi,ISNULL(Borc,0), ISNULL(Alacak,0), Fis_Detay_Aciklamasi FROM																																" + vbCrLf
            strProcedureText = strProcedureText + "							(																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Alinan Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'check' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Çek bordrosu'	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'çek'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHH_Log(NOLOCK) as R,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (R.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,R.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Alinan Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'senet'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OBOE_Log(NOLOCK) as R, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND R.CheckNo IS NOT NULL AND R.CheckNo >0																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,V.CheckNo) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHO_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OVPM(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND T.TransId = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,V.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OUTBOE_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							/*Alinan Senet Kontrolleri sss*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'other' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'dekont' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'banka'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORCT(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId  AND U.USERID = O.UserSign AND T.TransId = O.TransId 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OCHH_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OBOE_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2  																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							  UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN N.Canceled='N' AND O.FolioNum IS NOT NULL AND CONVERT(nvarchar,O.FolioNum)<>'' THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled='N' AND N.U_EFATNO  IS NOT NULL AND CONVERT(nvarchar,N.U_EFATNO)<>'' THEN CONVERT(nvarchar,N.U_EFATNO)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OINV(NOLOCK) as N,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 13 --AND N.Canceled='N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					     																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPI(NOLOCK) as P,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 203 --AND P.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORIN(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 14 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPO(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 204 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OPCH(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 18 --AND I.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN  NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORPC(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 19 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Istisna Disindakiler*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'shipment'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'receipt'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'masraf formu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'Z Raporu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'Navlum'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'Makbuz'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112)  																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.RefDate BETWEEN @B1 AND @B2 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 ) AS A  WHERE Borc>0 OR Alacak>0 ORDER BY  SiralamaTarihi,Fis_Numarasi--, Fiş_Numarası																																" + vbCrLf
            strProcedureText = strProcedureText + "					END																																		" + vbCrLf
            strProcedureText = strProcedureText + "					ELSE																																		" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN																																		" + vbCrLf
            strProcedureText = strProcedureText + "							SET @MyCursor = CURSOR FAST_FORWARD	FOR																															" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT Fisi_Kaydeden,Yevmiye_Tarihi,Fis_Numarasi,Fis_Satir_No,Kayit_Aciklamasi, ISNULL(Toplam_Borc,0), ISNULL(Toplam_Alacak,0), Firma_No,Sube_No,Kaynak_Referansi,Dokuman_Tipi,Dokuman_Tipi_Aciklamasi,Dokuman_No,Dokuman_Tarihi,Odeme_Yontemi,Satir_Madde_No,Ana_Hesap_Kodu,Ana_Hesap_Aciklamasi,Alt_Hesap_Kodu,Alt_Hesap_Aciklamasi,ISNULL(Borc,0), ISNULL(Alacak,0), Fis_Detay_Aciklamasi FROM																																" + vbCrLf
            strProcedureText = strProcedureText + "							(																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Alinan Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'check' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Çek bordrosu'	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'çek'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHH_Log(NOLOCK) as R,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (R.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,R.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Alinan Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,R.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'senet'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OBOE_Log(NOLOCK) as R, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND R.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 --AND R.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND R.CheckNo IS NOT NULL AND R.CheckNo >0																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,V.CheckNo) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OCHO_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							  /*Verilen Çek*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'check' 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'dekont'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE 'Çek bordrosu'																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)) THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)) THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)) THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OVPM(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND T.TransId = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "					  																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Verilen Senet Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'voucher' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'Senet bordrosu' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,V.CheckNo) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.TrsfrSum IS NOT NULL AND T.TrsfrSum >0) OR (T.TrsfrSumFC IS NOT NULL AND T.TrsfrSumFC>0)))>0 THEN 'banka'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CreditSum IS NOT NULL AND T.CreditSum >0) OR (T.CredSumFC IS NOT NULL AND T.CredSumFC>0)))>0 THEN 'kredi karti'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN (SELECT COUNT(1) FROM dbo.OVPM(NOLOCK) T WHERE T.TransId = O.TransId AND ((T.CashSum IS NOT NULL AND T.CashSum >0) OR (T.CashSumFC IS NOT NULL AND T.CashSumFC>0)))>0 THEN 'nakit'																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE ''																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ZAM_OUTBOE_Log(NOLOCK) as V,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND V.ObjectDocEntry = O.TransId AND U.USERID = O.UserSign  																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 46 --AND V.Canceled<>'Y'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (V.CheckNo IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,V.CheckNo)))>'')																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 UNION																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							/*Alinan Senet Kontrolleri sss*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'other' as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'dekont' as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(nvarchar,O.TransId) as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), J.RefDate, 112) as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'banka'	as Odeme_Yontemi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) AS Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORCT(NOLOCK) T, 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId  AND U.USERID = O.UserSign AND T.TransId = O.TransId 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 24 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OCHH_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransId NOT IN (SELECT ObjectDocEntry FROM dbo.ZAM_OBOE_Log(NOLOCK)) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.StornoToTr IS NULL																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4 																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							  UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112) as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN N.Canceled='N' AND O.FolioNum IS NOT NULL AND CONVERT(nvarchar,O.FolioNum)<>'' THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled='N' AND N.U_EFATNO  IS NOT NULL AND CONVERT(nvarchar,N.U_EFATNO)<>'' THEN CONVERT(nvarchar,N.U_EFATNO)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN N.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OINV(NOLOCK) as N,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 13 --AND N.Canceled='N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "					     																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 203) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN P.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPI(NOLOCK) as P,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 203 --AND P.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							  AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satis Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 14),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORIN(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 14 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 13) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N'THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 204) ,'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ODPO(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 204 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'') 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 18),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OPCH(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 18 --AND I.Canceled<> 'N' 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "								 UNION 																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Satinalma Kontrolleri*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_Tipi_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN '' 																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.NumAtCard IS NOT NULL AND RTRIM(LTRIM(CONVERT(nvarchar,I.NumAtCard)))<>'' THEN CONVERT(nvarchar,I.NumAtCard)																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN I.Canceled<> 'N' THEN  NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = 19),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112) 																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.ORPC(NOLOCK) as I,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TransType = 19 --AND I.Canceled<> 'N'																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND  (O.Indicator NOT IN ('D1', 'D2', 'D3', 'D4', 'D5', 'D6') OR O.Indicator IS NULL)																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							   UNION 																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					   																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 /*Istisna Disindakiler*/																																" + vbCrLf
            strProcedureText = strProcedureText + "							 SELECT 																																" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Yevmiye_Madde_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							U.USER_CODE as Fisi_Kaydeden,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(VARCHAR(8), O.RefDate, 112)  as  Yevmiye_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Fis_Numarasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Line_ID as Fis_Satir_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							ISNULL(O.Memo,'') as Kayit_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Debit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE (SELECT SUM(Credit) FROM dbo.JDT1(NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	 as Toplam_Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'1' as Firma_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "							'0' as Sube_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CONVERT(NVARCHAR,O.TransId) as Kaynak_Referansi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'other'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'shipment'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'receipt'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D1'  THEN 'masraf formu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D2'  THEN 'Z Raporu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D5'  THEN 'Navlum'																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN O.Indicator = 'D6'  THEN 'Makbuz'																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE ISNULL((SELECT U_BelTipTanim FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Dokuman_Tipi_Aciklamasi,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN ''																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			WHEN O.FolioNum IS NOT NULL AND O.FolioNum>0 THEN CONVERT(nvarchar,O.FolioNum)																															" + vbCrLf
            strProcedureText = strProcedureText + "					 			ELSE CONVERT(nvarchar,O.TransId)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN ISNULL((SELECT U_BelTip FROM dbo.[@EIntegDocVal](NOLOCK) WHERE U_SAPBelgeTuru = O.TransType),'')='' THEN NULL																															" + vbCrLf
            strProcedureText = strProcedureText + "								ELSE CONVERT(VARCHAR(8), O.RefDate, 112)  																															" + vbCrLf
            strProcedureText = strProcedureText + "							END as  Dokuman_Tarihi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							'' as Odeme_Yontemi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							NULL as Satir_Madde_No,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SUBSTRING(J.Account,1,3) as Ana_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account,1,3)) as Ana_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.Account as Alt_Hesap_Kodu,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							(SELECT TOP 1 AcctName FROM dbo.OACT(NOLOCK) T WHERE T.AcctCode = J.Account) as Alt_Hesap_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Borc,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							CASE 																																" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit																															" + vbCrLf
            strProcedureText = strProcedureText + "								WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)																															" + vbCrLf
            strProcedureText = strProcedureText + "							END	as Alacak,																															" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							J.LineMemo as Fis_Detay_Aciklamasi,																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							O.RefDate AS SiralamaTarihi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							 FROM dbo.OJDT(NOLOCK) as O, dbo.JDT1(NOLOCK) as J,																																" + vbCrLf
            strProcedureText = strProcedureText + "							 dbo.OUSR(NOLOCK) as U 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 WHERE J.TransId = O.TransId AND U.USERID = O.UserSign																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 																																" + vbCrLf
            strProcedureText = strProcedureText + "							 AND O.TaxDate BETWEEN @B3 AND @B4																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							 ) AS A  WHERE Borc>0 OR Alacak>0 ORDER BY  SiralamaTarihi,Fis_Numarasi--, Fiş_Numarası																																" + vbCrLf
            strProcedureText = strProcedureText + "					END																																		" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					OPEN @MyCursor																																		" + vbCrLf
            strProcedureText = strProcedureText + "					FETCH NEXT FROM @MyCursor INTO @Fisi_Kaydeden,@Yevmiye_Tarihi,@Fis_Numarasi,@Fis_Satir_No,@Kayit_Aciklamasi,@Toplam_Borc,@Toplam_Alacak,@Firma_No,@Sube_No,@Kaynak_Referansi,@Dokuman_Tipi,@Dokuman_Tipi_Aciklamasi,@Dokuman_No,@Dokuman_Tarihi,@Odeme_Yontemi,@Satir_Madde_No,@Ana_Hesap_Kodu,@Ana_Hesap_Aciklamasi,@Alt_Hesap_Kodu,@Alt_Hesap_Aciklamasi,@Borc,@Alacak,@Fis_Detay_Aciklamasi																																		" + vbCrLf
            strProcedureText = strProcedureText + "					WHILE @@FETCH_STATUS = 0																																		" + vbCrLf
            strProcedureText = strProcedureText + "						BEGIN																																	" + vbCrLf
            strProcedureText = strProcedureText + "							--@Yevmiye_Madde_Numarasi																																" + vbCrLf
            strProcedureText = strProcedureText + "							SET @intsatirMaddeNo = @intsatirMaddeNo +1																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							SET @strfisnoYeni = @Fis_Numarasi																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "					        If @strfisno = @strfisnoYeni 																																		" + vbCrLf
            strProcedureText = strProcedureText + "							BEGIN																																" + vbCrLf
            strProcedureText = strProcedureText + "								SET @LineId = @LineId + 1																															" + vbCrLf
            strProcedureText = strProcedureText + "							END																																" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE --@strfisno <> @strfisnoYeni 																																" + vbCrLf
            strProcedureText = strProcedureText + "							BEGIN																																" + vbCrLf
            strProcedureText = strProcedureText + "					            --SET @intsatirMaddeNo = 1																																		" + vbCrLf
            strProcedureText = strProcedureText + "								SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi + 1																															" + vbCrLf
            strProcedureText = strProcedureText + "								SET @LineId = @LineId + 1																															" + vbCrLf
            strProcedureText = strProcedureText + "					            SET @strfisno = @strfisnoYeni																																		" + vbCrLf
            strProcedureText = strProcedureText + "					        END																																		" + vbCrLf
            strProcedureText = strProcedureText + "							--@ObjectId																																" + vbCrLf
            strProcedureText = strProcedureText + "							--SET @LineId = @LineId + 1																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							IF @Dokuman_Tarihi = '1900-01-01 00:00:00.000'																																" + vbCrLf
            strProcedureText = strProcedureText + "								INSERT INTO [dbo].[@ELRAPVH]([DocEntry],[LineId],[VisOrder],[Object],[LogInst],[U_Yevmiye_Madde_No],[U_Fis_Numarasi],[U_Fis_Satir_No],[U_Yevmiye_Tarihi],[U_Fisi_Kaydeden],[U_Kayit_Acik],[U_Toplam_Borc],[U_Toplam_Alacak],[U_Satir_Madde_No],[U_Ana_Hesap_Kodu],[U_Ana_Hesap_Acik],[U_Alt_Hesap_Kodu],[U_Alt_Hesap_Acik],[U_Borc],[U_Alacak],[U_Dokuman_No],[U_Dokuman_Tipi],[U_Dokuman_Tipi_Acik],[U_Dokuman_Tarihi],[U_Odeme_Yontemi],[U_Fis_Detay_Acik],[U_Firma_No],[U_Sube_No],[U_Kaynak_Referansi])																															" + vbCrLf
            strProcedureText = strProcedureText + "									VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @Yevmiye_Madde_Numarasi, @Fis_Numarasi, @Fis_Satir_No + 1, @Yevmiye_Tarihi, @Fisi_Kaydeden, @Kayit_Aciklamasi, @Toplam_Borc, @Toplam_Alacak, @intsatirMaddeNo, @Ana_Hesap_Kodu, @Ana_Hesap_Aciklamasi, @Alt_Hesap_Kodu, @Alt_Hesap_Aciklamasi, @Borc, @Alacak, @Dokuman_No, @Dokuman_Tipi, @Dokuman_Tipi_Aciklamasi, NULL, @Odeme_Yontemi, @Fis_Detay_Aciklamasi, @Firma_No, @Sube_No, @Kaynak_Referansi)																														" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE																																" + vbCrLf
            strProcedureText = strProcedureText + "								INSERT INTO [dbo].[@ELRAPVH]([DocEntry],[LineId],[VisOrder],[Object],[LogInst],[U_Yevmiye_Madde_No],[U_Fis_Numarasi],[U_Fis_Satir_No],[U_Yevmiye_Tarihi],[U_Fisi_Kaydeden],[U_Kayit_Acik],[U_Toplam_Borc],[U_Toplam_Alacak],[U_Satir_Madde_No],[U_Ana_Hesap_Kodu],[U_Ana_Hesap_Acik],[U_Alt_Hesap_Kodu],[U_Alt_Hesap_Acik],[U_Borc],[U_Alacak],[U_Dokuman_No],[U_Dokuman_Tipi],[U_Dokuman_Tipi_Acik],[U_Dokuman_Tarihi],[U_Odeme_Yontemi],[U_Fis_Detay_Acik],[U_Firma_No],[U_Sube_No],[U_Kaynak_Referansi])																															" + vbCrLf
            strProcedureText = strProcedureText + "									VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @Yevmiye_Madde_Numarasi, @Fis_Numarasi, @Fis_Satir_No + 1, @Yevmiye_Tarihi, @Fisi_Kaydeden, @Kayit_Aciklamasi, @Toplam_Borc, @Toplam_Alacak, @intsatirMaddeNo, @Ana_Hesap_Kodu, @Ana_Hesap_Aciklamasi, @Alt_Hesap_Kodu, @Alt_Hesap_Aciklamasi, @Borc, @Alacak, @Dokuman_No, @Dokuman_Tipi, @Dokuman_Tipi_Aciklamasi, @Dokuman_Tarihi, @Odeme_Yontemi, @Fis_Detay_Aciklamasi, @Firma_No, @Sube_No, @Kaynak_Referansi)																														" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							--SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi + 1																																" + vbCrLf
            strProcedureText = strProcedureText + "																																							" + vbCrLf
            strProcedureText = strProcedureText + "							FETCH NEXT FROM @MyCursor																																" + vbCrLf
            strProcedureText = strProcedureText + "							INTO @Fisi_Kaydeden,@Yevmiye_Tarihi,@Fis_Numarasi,@Fis_Satir_No,@Kayit_Aciklamasi,@Toplam_Borc,@Toplam_Alacak,@Firma_No,@Sube_No,@Kaynak_Referansi,@Dokuman_Tipi,@Dokuman_Tipi_Aciklamasi,@Dokuman_No,@Dokuman_Tarihi,@Odeme_Yontemi,@Satir_Madde_No,@Ana_Hesap_Kodu,@Ana_Hesap_Aciklamasi,@Alt_Hesap_Kodu,@Alt_Hesap_Aciklamasi,@Borc,@Alacak,@Fis_Detay_Aciklamasi																																" + vbCrLf
            strProcedureText = strProcedureText + "						END																																	" + vbCrLf
            strProcedureText = strProcedureText + "					CLOSE @MyCursor																																		" + vbCrLf
            strProcedureText = strProcedureText + "					DEALLOCATE @MyCursor																																		" + vbCrLf


            oGFun.CreateProcedure("sp_EDefterGrid2", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
    Public Sub CreateEDefterGrid3()
        Try
            Dim strProcedureText As String = ""
            strProcedureText = strProcedureText + " 					" + vbCrLf
            strProcedureText = strProcedureText + "		 			CREATE PROCEDURE [dbo].[sp_EDefterGrid3] --'20150101' ,  '20150130',  '', '',  1, 1,1					" + vbCrLf
            strProcedureText = strProcedureText + "		 			(					" + vbCrLf
            strProcedureText = strProcedureText + "		 				@B1 datetime,  				" + vbCrLf
            strProcedureText = strProcedureText + "		 				@B2 datetime,  				" + vbCrLf
            strProcedureText = strProcedureText + "		 				@B3 datetime,  				" + vbCrLf
            strProcedureText = strProcedureText + "		 				@B4 datetime, 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				@DocEntry int, 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				@Yevmiye_Madde_Numarasi int,				" + vbCrLf
            strProcedureText = strProcedureText + "		 				@Satir_Madde_No int				" + vbCrLf
            strProcedureText = strProcedureText + "		 				)				" + vbCrLf
            strProcedureText = strProcedureText + "		 				AS				" + vbCrLf
            strProcedureText = strProcedureText + "		 					 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET NOCOUNT ON				" + vbCrLf
            strProcedureText = strProcedureText + "		 				IF @B1='' SET @B1 = '1900-01-01'				" + vbCrLf
            strProcedureText = strProcedureText + "		 				IF @B2='' SET @B2 = '2100-01-01'				" + vbCrLf
            strProcedureText = strProcedureText + "		 				IF @B3='' SET @B3 = '1900-01-01'				" + vbCrLf
            strProcedureText = strProcedureText + "		 				IF @B4='' SET @B4 = '2100-01-01'				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						DECLARE @Tarih as smallint				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @StartDate as datetime,  @EndDate as datetime,  @SDate nvarchar(8),  @EDate nvarchar(8)				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @detailref  int, @enteredby  nvarchar(50), @entereddate  date, @entryref  int, @linenumber  int, @linenumbercounter  int				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @SatirNo  int, @documenttype  nvarchar(50), @doctypedesc  nvarchar(100), @documentnumber  nvarchar(30)				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @entrynumbercounter  int, @documentdate  date, @paymentmethod  nvarchar(100), @accmainid  nvarchar(50)				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @accmainiddesc  nvarchar(100), @accsubdesc  nvarchar(200),  @accsubid  nvarchar(50),  @amount  numeric(19,6)				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @debitcreditcode  char(1), @postingdate  date, @detailcomment  nvarchar(250), @erpno  nvarchar(50)				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @divisionno nvarchar(50), @entrycomment nvarchar(200)				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @intsatirMaddeNo int,  @strfisnoYeni nvarchar(50),  @strfisno nvarchar(50),  @LineId int				" + vbCrLf
            strProcedureText = strProcedureText + "		 				DECLARE @ObjectId smallint, @transid int				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				IF @B1 <> '1900-01-01' 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				BEGIN				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SET @StartDate = @B1			" + vbCrLf
            strProcedureText = strProcedureText + "		 					SET @EndDate = @B2			" + vbCrLf
            strProcedureText = strProcedureText + "							SET @Tarih = 1			" + vbCrLf
            strProcedureText = strProcedureText + "		 				END				" + vbCrLf
            strProcedureText = strProcedureText + "		 				ELSE				" + vbCrLf
            strProcedureText = strProcedureText + "		 				BEGIN				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SET @StartDate = @B3			" + vbCrLf
            strProcedureText = strProcedureText + "		 					SET @EndDate = @B4			" + vbCrLf
            strProcedureText = strProcedureText + "							SET @Tarih = 2			" + vbCrLf
            strProcedureText = strProcedureText + "		 				END				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET @SDate = CONVERT(VARCHAR(8),  @StartDate,  112) 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET @EDate = CONVERT(VARCHAR(8),  @EndDate,  112) 				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				DELETE [dbo].[@ELRAPVI] WHERE [DocEntry] = @DocEntry				" + vbCrLf
            strProcedureText = strProcedureText + "		 					 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				IF @Yevmiye_Madde_Numarasi = 0 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				SELECT @Yevmiye_Madde_Numarasi = ISNULL(MAX([U_linenumbercounter]), 0)+1 from [dbo].[@ELRAPVI](NOLOCK)  WHERE Datepart(YYYY, getdate()) = Datepart(YYYY, [U_entereddate])				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				IF @Satir_Madde_No = 0				" + vbCrLf
            strProcedureText = strProcedureText + "		 				SELECT @Satir_Madde_No = ISNULL(MAX(U_linenumber),0)+1 from [dbo].[@ELRAPVI](NOLOCK) WHERE [U_linenumbercounter] = (@Yevmiye_Madde_Numarasi - 1)				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET @intsatirMaddeNo = @Satir_Madde_No - 1				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi -1				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET @strfisnoYeni = ''				" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET @strfisno = ''				" + vbCrLf
            strProcedureText = strProcedureText + "		 				SET @LineId = 0				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				SELECT @ObjectId =  Series from  [dbo].NNM1 WHERE ObjectCode = 'ELRAP' 				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 			DECLARE @MyCursor CURSOR					" + vbCrLf
            strProcedureText = strProcedureText + "					IF (@Tarih=1 )					" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN					" + vbCrLf
            strProcedureText = strProcedureText + "						    SET @MyCursor = CURSOR FAST_FORWARD	FOR			" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT  transid, detailref, enteredby, entereddate, entryref, linenumber, linenumbercounter, SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(documenttype,'NULL') as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE WHEN ISNULL(documenttype,'') = '' THEN 'NULL' ELSE doctypedesc END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE WHEN ISNULL(documenttype,'') = '' THEN 'NULL' ELSE documentnumber END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE WHEN ISNULL(documenttype,'') = '' THEN '' ELSE documentdate END as documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					paymentmethod, accmainid, accmainiddesc, accsubdesc, accsubid, amount, debitcreditcode, postingdate, detailcomment, erpno, divisionno, entrycomment FROM			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(			" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Alinan Çek & Alinan Senet Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref,  --Satir_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber,  --Satir_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as documenttype, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'dekont'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as doctypedesc, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN CONVERT(nvarchar, J.Ref3Line)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN CONVERT(nvarchar, R.BoeNum) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(nvarchar, J.TransID) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  J.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) THEN 'çek'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'banka'--*		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CreditSum IS NOT NULL AND R.CreditSum >0) OR (R.CredSumFC IS NOT NULL AND R.CredSumFC>0)) THEN 'kredi karti'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CashSum IS NOT NULL AND R.CashSum >0) OR (R.CashSumFC IS NOT NULL AND R.CashSumFC>0)) THEN 'nakit'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN 'Senet'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as paymentmethod, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) AS accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ORCT](NOLOCK) as R, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND R.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 24 --AND R.Canceled<>'Y'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.StornoToTr IS NULL		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		 " + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Verilen Çek & Senet Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE K.TransId = O.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE  CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as documenttype, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'dekont'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as doctypedesc, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN (SELECT CONVERT(nvarchar, K.Ref3Line) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId AND K.Line_ID = 0) --CONVERT(nvarchar, J.Ref3Line)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN CONVERT(nvarchar, V.BoeNum) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(nvarchar, J.TransID) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  J.RefDate,  112)  		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) THEN 'çek'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'banka'--*		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CreditSum IS NOT NULL AND V.CreditSum >0) OR (V.CredSumFC IS NOT NULL AND V.CredSumFC>0)) THEN 'kredi karti'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CashSum IS NOT NULL AND V.CashSum >0) OR (V.CashSumFC IS NOT NULL AND V.CashSumFC>0)) THEN 'nakit'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN 'Senet'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as paymentmethod, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J,  		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OVPM](NOLOCK) as V, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND V.TransId = O.TransId AND U.USERID = O.UserSign  		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 46 --AND V.Canceled<>'Y'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.StornoToTr IS NULL		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satis Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.FolioNum IS NOT NULL AND N.FolioNum>0 THEN CONVERT(nvarchar, N.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(N.U_EFATNO))<>'' THEN CONVERT(nvarchar, N.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OINV](NOLOCK) as N, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 13 --AND N.Canceled<> 'N' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 	     			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 	 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satis Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.FolioNum IS NOT NULL AND P.FolioNum>0 THEN CONVERT(nvarchar, P.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(P.U_EFATNO))<>'' THEN CONVERT(nvarchar, P.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ODPI](NOLOCK) as P, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 203 --AND P.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satis Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ORIN](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 14 --AND I.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 			UNION 	" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satinalma Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ODPO](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 204 --AND I.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 			UNION 	" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satinalma Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OPCH](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 18 --AND I.Canceled<> 'N' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 			UNION 	" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ORPC](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 19 --AND I.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					/*Istisna Disindakiler*/			" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D1'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D2'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D3'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D4'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D5'  THEN 'shipment'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D6'  THEN 'receipt'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as documenttype, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D1'  THEN 'masraf formu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D2'  THEN 'Z Raporu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D5'  THEN 'Navlum'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D6'  THEN 'Makbuz'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as doctypedesc, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.FolioNum IS NOT NULL THEN CONVERT(nvarchar, O.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.RefDate BETWEEN @B1 AND @B2 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						) AS A --WHERE amount>0 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ORDER BY  SiralamaTarihi		" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "					END					" + vbCrLf
            strProcedureText = strProcedureText + "					ELSE					" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN					" + vbCrLf
            strProcedureText = strProcedureText + "						    SET @MyCursor = CURSOR FAST_FORWARD	FOR			" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT  transid, detailref, enteredby, entereddate, entryref, linenumber, linenumbercounter, SatirNo, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(documenttype,'NULL') as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE WHEN ISNULL(documenttype,'') = '' THEN 'NULL' ELSE doctypedesc END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE WHEN ISNULL(documenttype,'') = '' THEN 'NULL' ELSE documentnumber END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE WHEN ISNULL(documenttype,'') = '' THEN '' ELSE documentdate END as documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					paymentmethod, accmainid, accmainiddesc, accsubdesc, accsubid, amount, debitcreditcode, postingdate, detailcomment, erpno, divisionno, entrycomment FROM			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(			" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Alinan Çek & Alinan Senet Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref,  --Satir_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber,  --Satir_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as documenttype, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'dekont'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as doctypedesc, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN CONVERT(nvarchar, J.Ref3Line)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN CONVERT(nvarchar, R.BoeNum) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(nvarchar, J.TransID) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  J.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN R.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) THEN 'çek'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'banka'--*		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CreditSum IS NOT NULL AND R.CreditSum >0) OR (R.CredSumFC IS NOT NULL AND R.CredSumFC>0)) THEN 'kredi karti'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.CashSum IS NOT NULL AND R.CashSum >0) OR (R.CashSumFC IS NOT NULL AND R.CashSumFC>0)) THEN 'nakit'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN 'Senet'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as paymentmethod, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) AS accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ORCT](NOLOCK) as R, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND R.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 24 --AND R.Canceled<>'Y'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.StornoToTr IS NULL		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		 " + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Verilen Çek & Senet Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE K.TransId = O.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE  CONVERT(NVARCHAR, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as documenttype, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'dekont'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as doctypedesc, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN (SELECT CONVERT(nvarchar, K.Ref3Line) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId AND K.Line_ID = 0) --CONVERT(nvarchar, J.Ref3Line)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN CONVERT(nvarchar, V.BoeNum) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(nvarchar, J.TransID) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  J.RefDate,  112)  		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN V.Canceled <> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) THEN 'çek'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'banka'--*		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CreditSum IS NOT NULL AND V.CreditSum >0) OR (V.CredSumFC IS NOT NULL AND V.CredSumFC>0)) THEN 'kredi karti'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.CashSum IS NOT NULL AND V.CashSum >0) OR (V.CashSumFC IS NOT NULL AND V.CashSumFC>0)) THEN 'nakit'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN 'Senet'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as paymentmethod, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J,  		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OVPM](NOLOCK) as V, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND V.TransId = O.TransId AND U.USERID = O.UserSign  		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 46 --AND V.Canceled<>'Y'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.StornoToTr IS NULL		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satis Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.FolioNum IS NOT NULL AND N.FolioNum>0 THEN CONVERT(nvarchar, N.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(N.U_EFATNO))<>'' THEN CONVERT(nvarchar, N.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN N.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OINV](NOLOCK) as N, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 13 --AND N.Canceled<> 'N' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 	     			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 	 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satis Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.FolioNum IS NOT NULL AND P.FolioNum>0 THEN CONVERT(nvarchar, P.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(P.U_EFATNO))<>'' THEN CONVERT(nvarchar, P.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN P.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ODPI](NOLOCK) as P, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 203 --AND P.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satis Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ORIN](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 14 --AND I.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 			UNION 	" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satinalma Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N'THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ODPO](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 204 --AND I.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 			UNION 	" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						/*Satinalma Kontrolleri*/		" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OPCH](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 18 --AND I.Canceled<> 'N' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 			UNION 	" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN '' 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN I.Canceled<> 'N' THEN ''		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(VARCHAR(8),  O.RefDate,  112) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[ORPC](NOLOCK) as I, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TransType = 19 --AND I.Canceled<> 'N'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					/*Istisna Disindakiler*/			" + vbCrLf
            strProcedureText = strProcedureText + "		 					SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.TransId as transid,			" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL as detailref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					U.U_NAME as enteredby, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(NVARCHAR, O.TransId) as entryref, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL linenumbercounter,  --yevmiye_madde_no			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Line_ID as SatirNo, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D1'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D2'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D3'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D4'  THEN 'other'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D5'  THEN 'shipment'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D6'  THEN 'receipt'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as documenttype, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D1'  THEN 'masraf formu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D2'  THEN 'Z Raporu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D5'  THEN 'Navlum'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.Indicator = 'D6'  THEN 'Makbuz'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as doctypedesc, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN O.FolioNum IS NOT NULL THEN CONVERT(nvarchar, O.FolioNum)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ELSE CONVERT(nvarchar, O.TransId)		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END as documentnumber, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					NULL entrynumbercounter, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  documentdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'' as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					SUBSTRING(J.Account, 1, 3) as accmainid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.Account as accsubid, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as amount, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CASE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END	as debitcreditcode, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					J.LineMemo as detailcomment, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 					'00101' as erpno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					'0' as divisionno, 			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					ISNULL(O.Memo,'') as entrycomment,			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					O.RefDate AS SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						[dbo].[OUSR](NOLOCK) as U 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						WHERE J.TransId = O.TransId AND U.USERID = O.UserSign		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						AND O.TaxDate BETWEEN @B3 AND @B4		" + vbCrLf
            strProcedureText = strProcedureText + "		 				 				" + vbCrLf
            strProcedureText = strProcedureText + "		 						) AS A --WHERE amount>0 		" + vbCrLf
            strProcedureText = strProcedureText + "		 						ORDER BY  SiralamaTarihi		" + vbCrLf
            strProcedureText = strProcedureText + "					END					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "		 			OPEN @MyCursor					" + vbCrLf
            strProcedureText = strProcedureText + "		 			FETCH NEXT FROM @MyCursor INTO 	@transid, @detailref,  @enteredby,  @entereddate,  @entryref,  @linenumber,  @linenumbercounter,  @SatirNo,  @documenttype,  @doctypedesc,  @documentnumber,  @entrynumbercounter,  @documentdate,  @paymentmethod,  @accmainid,  @accmainiddesc,  @accsubdesc,  @accsubid,  @amount,  @debitcreditcode,  @postingdate,  @detailcomment,  @erpno,  @divisionno, @entrycomment 	" + vbCrLf
            strProcedureText = strProcedureText + "		 			WHILE @@FETCH_STATUS = 0					" + vbCrLf
            strProcedureText = strProcedureText + "		 				BEGIN				" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					SET @intsatirMaddeNo = @intsatirMaddeNo +1			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					SET @strfisnoYeni = @entryref			" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					If @strfisno = @strfisnoYeni 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					BEGIN			" + vbCrLf
            strProcedureText = strProcedureText + "		 						SET @LineId = @LineId + 1		" + vbCrLf
            strProcedureText = strProcedureText + "		 					END			" + vbCrLf
            strProcedureText = strProcedureText + "		 					ELSE 			" + vbCrLf
            strProcedureText = strProcedureText + "		 					BEGIN			" + vbCrLf
            strProcedureText = strProcedureText + "		 						SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi + 1		" + vbCrLf
            strProcedureText = strProcedureText + "		 						SET @LineId = @LineId + 1		" + vbCrLf
            strProcedureText = strProcedureText + "		 					    SET @strfisno = @strfisnoYeni			" + vbCrLf
            strProcedureText = strProcedureText + "		 					END			" + vbCrLf
            strProcedureText = strProcedureText + "		 					IF LTRIM(RTRIM(@documenttype)) = ''	SET @documenttype = 'NULL'		" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					IF @documentdate = '1900-01-01'			" + vbCrLf
            strProcedureText = strProcedureText + "		 						INSERT INTO [dbo].[@ELRAPVI]([DocEntry], [LineId], [VisOrder], [Object], [LogInst], [U_transid], [U_detailref], [U_entryref], [U_linenumber], [U_linenumbercounter], [U_accmainid], [U_accmainiddesc], [U_accsubid], [U_accsubdesc], [U_amount], [U_debitcreditcode], [U_postingdate], [U_documenttype], [U_doctypedesc], [U_documentnumber], [U_documentreference], [U_entrynumbercounter], [U_documentdate], [U_paymentmethod], [U_detailcomment], [U_erpno], [U_divisionno], [U_enteredby], [U_entereddate], [U_entrynumber], [U_entrycomment])		" + vbCrLf
            strProcedureText = strProcedureText + "		 							VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @transid, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @accmainid, @accmainiddesc, @accsubid, @accsubdesc, @amount, @debitcreditcode, @postingdate, @documenttype, @doctypedesc, @documentnumber, @Yevmiye_Madde_Numarasi, @Yevmiye_Madde_Numarasi, NULL, @paymentmethod, @detailcomment, @erpno,  @divisionno, @enteredby,  @entereddate, @Yevmiye_Madde_Numarasi, @entrycomment)	" + vbCrLf
            strProcedureText = strProcedureText + "		 							--VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @intsatirMaddeNo, @entryref, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @accmainid, @accmainiddesc, @accsubid, @accsubdesc, @amount, @debitcreditcode, @postingdate, @documenttype, @doctypedesc, @documen	" + vbCrLf
            strProcedureText = strProcedureText + "		 					ELSE			" + vbCrLf
            strProcedureText = strProcedureText + "		 						INSERT INTO [dbo].[@ELRAPVI]([DocEntry], [LineId], [VisOrder], [Object], [LogInst], [U_transid], [U_detailref], [U_entryref], [U_linenumber], [U_linenumbercounter], [U_accmainid], [U_accmainiddesc], [U_accsubid], [U_accsubdesc], [U_amount], [U_debitcreditcode], [U_postingdate], [U_documenttype], [U_doctypedesc], [U_documentnumber], [U_documentreference], [U_entrynumbercounter], [U_documentdate], [U_paymentmethod], [U_detailcomment], [U_erpno], [U_divisionno], [U_enteredby], [U_entereddate], [U_entrynumber], [U_entrycomment])		" + vbCrLf
            strProcedureText = strProcedureText + "		 							VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @transid, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @accmainid, @accmainiddesc, @accsubid, @accsubdesc, @amount, @debitcreditcode, @postingdate, @documenttype, @doctypedesc, @documentnumber, @Yevmiye_Madde_Numarasi, @Yevmiye_Madde_Numarasi, @documentdate, @paymentmethod, @detailcomment, @erpno,  @divisionno, @enteredby,  @entereddate, @Yevmiye_Madde_Numarasi, @entrycomment)	" + vbCrLf
            strProcedureText = strProcedureText + "		 							--VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @intsatirMaddeNo, @entryref, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @accmainid, @accmainiddesc, @accsubid, @accsubdesc, @amount, @debitcreditcode, @postingdate, @documenttype, @doctypedesc, @documen	" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 								" + vbCrLf
            strProcedureText = strProcedureText + "		 					FETCH NEXT FROM @MyCursor			" + vbCrLf
            strProcedureText = strProcedureText + "		 					INTO @transid, @detailref,  @enteredby,  @entereddate,  @entryref,  @linenumber,  @linenumbercounter,  @SatirNo,  @documenttype,  @doctypedesc,  @documentnumber,  @entrynumbercounter,  @documentdate,  @paymentmethod,  @accmainid,  @accmainiddesc,  @accsubdesc,  @accsubid,  @amount,  @debitcreditcode,  @postingdate,  @detailcomment,  @erpno,  @divisionno, @entrycomment			" + vbCrLf
            strProcedureText = strProcedureText + "		 				END				" + vbCrLf
            strProcedureText = strProcedureText + "		 			CLOSE @MyCursor					" + vbCrLf
            strProcedureText = strProcedureText + "		 			DEALLOCATE @MyCursor					" + vbCrLf


            oGFun.CreateProcedure("sp_EDefterGrid3", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
    Public Sub CreateEDefterGrid3_HANA()
        Try
            Dim strProcedureText As String = ""

            Dim strPath As String = System.Windows.Forms.Application.StartupPath & "\Script\sp_EDefterGrid3.txt"
            strProcedureText = File.ReadAllText(strPath)

            oGFun.CreateProcedure("SP_EDEFTERGRID3", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
    Public Sub CreateEDefterExcel3()
        Try
            Dim strProcedureText As String = ""

            strProcedureText = strProcedureText + " 			CREATE PROCEDURE [dbo].[sp_EDefterExcel3] --1				" + vbCrLf
            strProcedureText = strProcedureText + " 			(				" + vbCrLf
            strProcedureText = strProcedureText + " 			@DocEntry int 				" + vbCrLf
            strProcedureText = strProcedureText + " 			)				" + vbCrLf
            strProcedureText = strProcedureText + " 			AS				" + vbCrLf
            strProcedureText = strProcedureText + " 					 		" + vbCrLf
            strProcedureText = strProcedureText + " 			SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + " 				U_detailref,U_entryref,U_linenumber,U_linenumbercounter,U_accmainid,U_accmainiddesc,U_accsubid,U_accsubdesc,U_amount,			" + vbCrLf
            strProcedureText = strProcedureText + " 				U_debitcreditcode,			" + vbCrLf
            strProcedureText = strProcedureText + " 				CONVERT(VARCHAR(10), U_postingdate, 120) as U_postingdate,			" + vbCrLf
            strProcedureText = strProcedureText + " 				IIF((U_documenttype = '' OR U_documenttype IS NULL), 'NULL',U_documenttype) as U_documenttype,			" + vbCrLf
            strProcedureText = strProcedureText + " 				CASE 			" + vbCrLf
            strProcedureText = strProcedureText + " 					WHEN (U_documenttype = '' OR U_documenttype IS NULL) THEN 'NULL'		" + vbCrLf
            strProcedureText = strProcedureText + " 					ELSE IIF((U_doctypedesc = '' OR U_doctypedesc IS NULL), 'NULL',U_doctypedesc) 		" + vbCrLf
            strProcedureText = strProcedureText + " 				END as U_doctypedesc,			" + vbCrLf
            strProcedureText = strProcedureText + " 				CASE 			" + vbCrLf
            strProcedureText = strProcedureText + " 					WHEN (U_documenttype = '' OR U_documenttype IS NULL) THEN 'NULL'		" + vbCrLf
            strProcedureText = strProcedureText + " 					ELSE CONVERT(nvarchar,U_documentnumber) 		" + vbCrLf
            strProcedureText = strProcedureText + " 				END as U_documentnumber,			" + vbCrLf
            strProcedureText = strProcedureText + " 				U_documentreference,U_entrynumbercounter,			" + vbCrLf
            strProcedureText = strProcedureText + " 				CASE 			" + vbCrLf
            strProcedureText = strProcedureText + " 					WHEN (U_documenttype = '' OR U_documenttype IS NULL) THEN NULL		" + vbCrLf
            strProcedureText = strProcedureText + " 					ELSE CONVERT(VARCHAR(10), U_documentdate, 120)  		" + vbCrLf
            strProcedureText = strProcedureText + " 				END as U_documentdate,			" + vbCrLf
            strProcedureText = strProcedureText + " 				U_paymentmethod,			" + vbCrLf
            strProcedureText = strProcedureText + " 				ISNULL(U_detailcomment,'') as U_detailcomment,			" + vbCrLf
            strProcedureText = strProcedureText + " 				U_erpno, U_divisionno, U_enteredby,			" + vbCrLf
            strProcedureText = strProcedureText + " 				CONVERT(VARCHAR(10), U_entereddate, 120) as U_entereddate,			" + vbCrLf
            strProcedureText = strProcedureText + " 				U_entrynumber,			" + vbCrLf
            strProcedureText = strProcedureText + " 				ISNULL(U_entrycomment,'') as U_entrycomment			" + vbCrLf
            strProcedureText = strProcedureText + " 			FROM [dbo].[@ELRAPVI](NOLOCK) 				" + vbCrLf
            strProcedureText = strProcedureText + " 			WHERE DocEntry = @DocEntry 				" + vbCrLf
            strProcedureText = strProcedureText + " 			AND U_amount>0				" + vbCrLf
            strProcedureText = strProcedureText + " 			ORDER BY U_detailref				" + vbCrLf
            strProcedureText = strProcedureText + " 		 FOR BROWSE 					" + vbCrLf




            oGFun.CreateProcedure("sp_EDefterExcel3", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub

    Public Sub CreateEDefterExcel3_HANA()
        Try
            Dim strProcedureText As String = ""

            Dim strPath As String = System.Windows.Forms.Application.StartupPath & "\Script\sp_EDefterExcel3.txt"
            strProcedureText = File.ReadAllText(strPath)

            oGFun.CreateProcedure("SP_EDEFTEREXCEL3", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
    Public Sub CreateEDefterGrid4()
        Try
            Dim strProcedureText As String = ""
            strProcedureText = strProcedureText + " 					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "				CREATE PROCEDURE [dbo].[sp_EDefterGrid4] --'20150528' ,  '20150528',  '', '',  1, 1,1						" + vbCrLf
            strProcedureText = strProcedureText + "				(						" + vbCrLf
            strProcedureText = strProcedureText + "					@B1 datetime,  					" + vbCrLf
            strProcedureText = strProcedureText + "					@B2 datetime,  					" + vbCrLf
            strProcedureText = strProcedureText + "					@B3 datetime,  					" + vbCrLf
            strProcedureText = strProcedureText + "					@B4 datetime, 					" + vbCrLf
            strProcedureText = strProcedureText + "					@DocEntry int, 					" + vbCrLf
            strProcedureText = strProcedureText + "					@Yevmiye_Madde_Numarasi int,					" + vbCrLf
            strProcedureText = strProcedureText + "					@Satir_Madde_No int					" + vbCrLf
            strProcedureText = strProcedureText + "					)					" + vbCrLf
            strProcedureText = strProcedureText + "					AS					" + vbCrLf
            strProcedureText = strProcedureText + "							 			" + vbCrLf
            strProcedureText = strProcedureText + "					SET NOCOUNT ON					" + vbCrLf
            strProcedureText = strProcedureText + "					IF @B1='' SET @B1 = '1900-01-01'					" + vbCrLf
            strProcedureText = strProcedureText + "					IF @B2='' SET @B2 = '2100-01-01'					" + vbCrLf
            strProcedureText = strProcedureText + "					IF @B3='' SET @B3 = '1900-01-01'					" + vbCrLf
            strProcedureText = strProcedureText + "					IF @B4='' SET @B4 = '2100-01-01'					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @Tarih as smallint 					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @StartDate as datetime,  @EndDate as datetime,  @SDate nvarchar(8),  @EDate nvarchar(8)					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @entryref nvarchar(50), @enteredby  nvarchar(50), @entereddate  nvarchar(8), @linenumber  int, @linenumbercounter  int					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @SatirNo  int, @documenttype  nvarchar(50), @doctypedesc  nvarchar(100), @documentnumber  nvarchar(30)					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @documentdate  nvarchar(10), @paymentmethod  nvarchar(100), @accmainid  nvarchar(50)					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @accmainiddesc  nvarchar(100), @accsubdesc  nvarchar(200),  @accsubid  nvarchar(50)					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @debitcreditcode  char(1), @postingdate  nvarchar(8), @detailcomment  nvarchar(250)					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @entrycomment nvarchar(200),  @amount  numeric(19,6),@totaldebit numeric(19,6), @totalcredit numeric(19,6)					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @intsatirMaddeNo int,  @strfisnoYeni nvarchar(50),  @strfisno nvarchar(50),  @LineId int					" + vbCrLf
            strProcedureText = strProcedureText + "					DECLARE @ObjectId smallint, @bastar date, @bittar date					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					IF @B1 <> '1900-01-01' 					" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN					" + vbCrLf
            strProcedureText = strProcedureText + "						SET @StartDate = @B1				" + vbCrLf
            strProcedureText = strProcedureText + "						SET @EndDate = @B2				" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 1				" + vbCrLf
            strProcedureText = strProcedureText + "					END					" + vbCrLf
            strProcedureText = strProcedureText + "					ELSE					" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN					" + vbCrLf
            strProcedureText = strProcedureText + "						SET @StartDate = @B3				" + vbCrLf
            strProcedureText = strProcedureText + "						SET @EndDate = @B4				" + vbCrLf
            strProcedureText = strProcedureText + "						SET @Tarih = 2				" + vbCrLf
            strProcedureText = strProcedureText + "					END					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					--SET @SDate = CONVERT(VARCHAR(8),  @StartDate,  112) 					" + vbCrLf
            strProcedureText = strProcedureText + "					--SET @EDate = CONVERT(VARCHAR(8),  @EndDate,  112) 					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					DELETE [dbo].[@ELRAPVB] WHERE [DocEntry] = @DocEntry					" + vbCrLf
            strProcedureText = strProcedureText + "							 			" + vbCrLf
            strProcedureText = strProcedureText + "					IF @Yevmiye_Madde_Numarasi = 0 					" + vbCrLf
            strProcedureText = strProcedureText + "					SELECT @Yevmiye_Madde_Numarasi = ISNULL(MAX([U_linenumbercounter]), 0)+1 from [dbo].[@ELRAPVB](NOLOCK)  WHERE Datepart(YYYY, getdate()) = Datepart(YYYY, [U_entereddate])					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					IF @Satir_Madde_No = 0					" + vbCrLf
            strProcedureText = strProcedureText + "					SELECT @Satir_Madde_No = ISNULL(MAX(U_linenumber),0)+1 from [dbo].[@ELRAPVB](NOLOCK) WHERE [U_linenumbercounter] = (@Yevmiye_Madde_Numarasi -1)					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					SET @intsatirMaddeNo = @Satir_Madde_No - 1					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi -1					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					SET @strfisnoYeni = ''					" + vbCrLf
            strProcedureText = strProcedureText + "					SET @strfisno = ''					" + vbCrLf
            strProcedureText = strProcedureText + "					SET @LineId = 0					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "					SELECT @ObjectId =  Series from  [dbo].NNM1 WHERE ObjectCode = 'ELRAP' 					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "				DECLARE @MyCursor CURSOR						" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "				IF (@Tarih=1 )						" + vbCrLf
            strProcedureText = strProcedureText + "				BEGIN						" + vbCrLf
            strProcedureText = strProcedureText + "					SET @MyCursor = CURSOR FAST_FORWARD	FOR				" + vbCrLf
            strProcedureText = strProcedureText + "					SELECT  startdate, enddate, enteredby, entereddate, entryref, linenumber, linenumbercounter, SatirNo, totaldebit, totalcredit, 					" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(documenttype,'') as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN LTRIM(RTRIM(ISNULL(documenttype,'')))='' THEN '' ELSE doctypedesc END doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN LTRIM(RTRIM(ISNULL(documenttype,'')))='' THEN '' ELSE documentnumber END documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN LTRIM(RTRIM(ISNULL(documenttype,'')))='' THEN NULL ELSE CONVERT(nvarchar(10),documentdate,120) END documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						paymentmethod, accmainid, accmainiddesc, accsubdesc, accsubid, amount, debitcreditcode, postingdate, detailcomment,entrycomment FROM				" + vbCrLf
            strProcedureText = strProcedureText + "						(				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Alinan Çek & Alinan Senet Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber,  --Satir_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'dekont'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN CONVERT(nvarchar, J.Ref3Line)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN CONVERT(nvarchar, R.BoeNum) 			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(nvarchar, J.TransID) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) THEN 'çek'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'banka'--*			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CreditSum IS NOT NULL AND R.CreditSum >0) OR (R.CredSumFC IS NOT NULL AND R.CredSumFC>0)) THEN 'kredi karti'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CashSum IS NOT NULL AND R.CashSum >0) OR (R.CashSumFC IS NOT NULL AND R.CashSumFC>0)) THEN 'nakit'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN 'Senet'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) AS accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ORCT](NOLOCK) as R, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND R.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 24 --AND R.Canceled<>'Y'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.StornoToTr IS NULL			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 		 	" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "							 			" + vbCrLf
            strProcedureText = strProcedureText + "							/*Verilen Çek & Senet Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE K.TransId = O.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE  CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'dekont'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN (SELECT CONVERT(nvarchar, K.Ref3Line) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId AND K.Line_ID = 0) --CONVERT(nvarchar, J.Ref3Line)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN CONVERT(nvarchar, V.BoeNum) 			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(nvarchar, J.TransID) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) THEN 'çek'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'banka'--*			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CreditSum IS NOT NULL AND V.CreditSum >0) OR (V.CredSumFC IS NOT NULL AND V.CredSumFC>0)) THEN 'kredi karti'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CashSum IS NOT NULL AND V.CashSum >0) OR (V.CashSumFC IS NOT NULL AND V.CashSumFC>0)) THEN 'nakit'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN 'Senet'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J,  			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OVPM](NOLOCK) as V, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND V.TransId = O.TransId AND U.USERID = O.UserSign  			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 46 --AND V.Canceled<>'Y'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.StornoToTr IS NULL			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satis Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.FolioNum IS NOT NULL AND N.FolioNum>0 THEN CONVERT(nvarchar, N.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(N.U_EFATNO))<>'' THEN CONVERT(nvarchar, N.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OINV](NOLOCK) as N, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 13 --AND N.Canceled<> 'N' 			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 	     			" + vbCrLf
            strProcedureText = strProcedureText + "						 	 			" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satis Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.FolioNum IS NOT NULL AND P.FolioNum>0 THEN CONVERT(nvarchar, P.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(P.U_EFATNO))<>'' THEN CONVERT(nvarchar, P.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ODPI](NOLOCK) as P, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 203 --AND P.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satis Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ORIN](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 14 --AND I.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ODPO](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 204 --AND I.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OPCH](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 18 --AND I.Canceled<> 'N' 			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ORPC](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 19 --AND I.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Istisna Disindakiler*/			" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D1'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D2'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D3'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D4'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D5'  THEN 'shipment'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D6'  THEN 'receipt'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D1'  THEN 'masraf formu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D2'  THEN 'Z Raporu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D5'  THEN 'Navlum'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D6'  THEN 'Makbuz'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.FolioNum IS NOT NULL THEN CONVERT(nvarchar, O.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(10),  J.RefDate,  120)   as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.RefDate BETWEEN @B1 AND @B2 			" + vbCrLf
            strProcedureText = strProcedureText + "							) AS A WHERE ISNULL(amount,0)>0 			" + vbCrLf
            strProcedureText = strProcedureText + "							ORDER BY  SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "				END						" + vbCrLf
            strProcedureText = strProcedureText + "				ELSE						" + vbCrLf
            strProcedureText = strProcedureText + "				BEGIN						" + vbCrLf
            strProcedureText = strProcedureText + "					SET @MyCursor = CURSOR FAST_FORWARD FOR					" + vbCrLf
            strProcedureText = strProcedureText + "					SELECT  startdate, enddate, enteredby, entereddate, entryref, linenumber, linenumbercounter, SatirNo, totaldebit, totalcredit, 					" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(documenttype,'') as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN LTRIM(RTRIM(ISNULL(documenttype,'')))='' THEN '' ELSE doctypedesc END doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN LTRIM(RTRIM(ISNULL(documenttype,'')))='' THEN '' ELSE documentnumber END documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE WHEN LTRIM(RTRIM(ISNULL(documenttype,'')))='' THEN NULL ELSE CONVERT(nvarchar(10),documentdate,120) END documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						paymentmethod, accmainid, accmainiddesc, accsubdesc, accsubid, amount, debitcreditcode, postingdate, detailcomment,entrycomment FROM				" + vbCrLf
            strProcedureText = strProcedureText + "						(				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Alinan Çek & Alinan Senet Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber,  --Satir_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'dekont'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN CONVERT(nvarchar, J.Ref3Line)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN CONVERT(nvarchar, R.BoeNum) 			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(nvarchar, J.TransID) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN R.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CheckSum IS NOT NULL AND R.CheckSum >0) OR (R.CheckSumFC IS NOT NULL AND R.CheckSumFC>0)) THEN 'çek'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.TrsfrSum IS NOT NULL AND R.TrsfrSum >0) OR (R.TrsfrSumFC IS NOT NULL AND R.TrsfrSumFC>0)) THEN 'banka'--*			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CreditSum IS NOT NULL AND R.CreditSum >0) OR (R.CredSumFC IS NOT NULL AND R.CredSumFC>0)) THEN 'kredi karti'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.CashSum IS NOT NULL AND R.CashSum >0) OR (R.CashSumFC IS NOT NULL AND R.CashSumFC>0)) THEN 'nakit'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((R.BoeSum IS NOT NULL AND R.BoeSum >0) OR (R.BoeSumFc IS NOT NULL AND R.BoeSumFc>0)) THEN 'Senet'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) AS accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ORCT](NOLOCK) as R, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND R.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 24 --AND R.Canceled<>'Y'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.StornoToTr IS NULL			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4		 	" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "							 			" + vbCrLf
            strProcedureText = strProcedureText + "							/*Verilen Çek & Senet Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE K.TransId = O.TransId) > 2 THEN CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE  CONVERT(NVARCHAR, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 THEN 'check'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 1 THEN 'voucher'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'dekont'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) >= 2  THEN 'Çek bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId)>1  THEN 'Senet Bordrosu'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) = 2 AND J.Ref3Line IS NOT NULL AND LTRIM(RTRIM(CONVERT(nvarchar, J.Ref3Line)))<>'' THEN (SELECT CONVERT(nvarchar, K.Ref3Line) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId AND K.Line_ID = 0) --CONVERT(nvarchar, J.Ref3Line)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) AND (SELECT COUNT(1) FROM [dbo].[JDT1](NOLOCK) as K WHERE O.TransId = K.TransId) > 2 THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN CONVERT(nvarchar, V.BoeNum) 			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(nvarchar, J.TransID) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN V.Canceled <> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CheckSum IS NOT NULL AND V.CheckSum >0) OR (V.CheckSumFC IS NOT NULL AND V.CheckSumFC>0)) THEN 'çek'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.TrsfrSum IS NOT NULL AND V.TrsfrSum >0) OR (V.TrsfrSumFC IS NOT NULL AND V.TrsfrSumFC>0)) THEN 'banka'--*			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CreditSum IS NOT NULL AND V.CreditSum >0) OR (V.CredSumFC IS NOT NULL AND V.CredSumFC>0)) THEN 'kredi karti'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.CashSum IS NOT NULL AND V.CashSum >0) OR (V.CashSumFC IS NOT NULL AND V.CashSumFC>0)) THEN 'nakit'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN ((V.BoeSum IS NOT NULL AND V.BoeSum >0) OR (V.BoeSumFc IS NOT NULL AND V.BoeSumFc>0)) THEN 'Senet'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as paymentmethod, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J,  			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OVPM](NOLOCK) as V, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND V.TransId = O.TransId AND U.USERID = O.UserSign  			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 46 --AND V.Canceled<>'Y'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.StornoToTr IS NULL			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satis Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112) as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 13)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.FolioNum IS NOT NULL AND N.FolioNum>0 THEN CONVERT(nvarchar, N.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(N.U_EFATNO))<>'' THEN CONVERT(nvarchar, N.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN N.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OINV](NOLOCK) as N, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND N.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 13 --AND N.Canceled<> 'N' 			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 	     			" + vbCrLf
            strProcedureText = strProcedureText + "						 	 			" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satis Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 203)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.FolioNum IS NOT NULL AND P.FolioNum>0 THEN CONVERT(nvarchar, P.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(P.U_EFATNO))<>'' THEN CONVERT(nvarchar, P.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN P.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ODPI](NOLOCK) as P, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND P.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 203 --AND P.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satis Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 14)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ORIN](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 14 --AND I.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 204)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N'THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ODPO](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 204 --AND I.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "						SELECT 				" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 18)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OPCH](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE  J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 18 --AND I.Canceled<> 'N' 			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "								UNION 		" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Satinalma Kontrolleri*/			" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19) 			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documenttype, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = 19)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as doctypedesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN '' 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.FolioNum IS NOT NULL AND I.FolioNum>0 THEN CONVERT(nvarchar, I.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.U_EFATNO IS NOT NULL AND LTRIM(RTRIM(I.U_EFATNO))<>'' THEN CONVERT(nvarchar, I.U_EFATNO)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.TransId IS NOT NULL THEN CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE ''			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN I.Canceled<> 'N' THEN ''			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(VARCHAR(10),  J.RefDate,  120)  			" + vbCrLf
            strProcedureText = strProcedureText + "						END as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[ORPC](NOLOCK) as I, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND I.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TransType = 19 --AND I.Canceled<> 'N'			" + vbCrLf
            strProcedureText = strProcedureText + "							AND  (O.Indicator NOT IN ('D1',  'D2',  'D3',  'D4',  'D5',  'D6') OR O.Indicator IS NULL)			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							UNION 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							/*Istisna Disindakiler*/			" + vbCrLf
            strProcedureText = strProcedureText + "							SELECT 			" + vbCrLf
            strProcedureText = strProcedureText + "						@StartDate as startdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						@EndDate as enddate,				" + vbCrLf
            strProcedureText = strProcedureText + "						U.USER_CODE as enteredby, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  entereddate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(NVARCHAR, O.TransId) as entryref, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						NULL linenumbercounter,  --yevmiye_madde_no				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						J.Line_ID as SatirNo, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D') <0 THEN (SELECT -1*SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Debit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'D')			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totaldebit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C') <0 THEN (SELECT -1*SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT SUM(Credit) FROM [dbo].[JDT1](NOLOCK) as W WHERE W.Transid = O.Transid AND W.DebCred = 'C')---1*O.LocTotal			" + vbCrLf
            strProcedureText = strProcedureText + "						END	 as totalcredit,			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D1'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D2'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D3'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D4'  THEN 'other'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D5'  THEN 'shipment'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D6'  THEN 'receipt'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTip, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as documenttype, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D1'  THEN 'masraf formu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D2'  THEN 'Z Raporu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D3'  THEN 'Ücret Bordrosu Icmali'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D4'  THEN 'serbest meslek makbuzu'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D5'  THEN 'Navlum'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.Indicator = 'D6'  THEN 'Makbuz'			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE (SELECT ISNULL(U_BelTipTanim, '') FROM [dbo].[@EIntegDocVal](NOLOCK) as G WHERE G.U_SAPBelgeTuru = O.TransType)			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as doctypedesc, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN O.FolioNum IS NOT NULL THEN CONVERT(nvarchar, O.FolioNum)			" + vbCrLf
            strProcedureText = strProcedureText + "							ELSE CONVERT(nvarchar, O.TransId)			" + vbCrLf
            strProcedureText = strProcedureText + "						END as documentnumber, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(10),  J.RefDate,  120)   as  documentdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						'' as paymentmethod, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						SUBSTRING(J.Account, 1, 3) as accmainid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = SUBSTRING(J.Account, 1, 3)) as accmainiddesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						(SELECT TOP 1 AcctName FROM [dbo].[OACT](NOLOCK) T WHERE T.AcctCode = J.Account) as accsubdesc, 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.Account as accsubid, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN (-1*J.Credit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN J.Credit			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN (-1*J.Debit)			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN J.Debit			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as amount, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CASE 				" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit<0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'C' AND J.Credit>0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit<0 THEN 'C'			" + vbCrLf
            strProcedureText = strProcedureText + "							WHEN J.DebCred = 'D' AND J.Debit>0 THEN 'D'			" + vbCrLf
            strProcedureText = strProcedureText + "						END	as debitcreditcode, 			" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						CONVERT(VARCHAR(8),  O.RefDate,  112)  as  postingdate, 				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "						J.LineMemo as detailcomment, 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						ISNULL(O.Memo,'') as entrycomment,				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						O.RefDate AS SiralamaTarihi				" + vbCrLf
            strProcedureText = strProcedureText + "						 				" + vbCrLf
            strProcedureText = strProcedureText + "							FROM [dbo].[OJDT](NOLOCK) as O,  [dbo].[JDT1](NOLOCK) as J, 			" + vbCrLf
            strProcedureText = strProcedureText + "							[dbo].[OUSR](NOLOCK) as U 			" + vbCrLf
            strProcedureText = strProcedureText + "							WHERE J.TransId = O.TransId AND U.USERID = O.UserSign			" + vbCrLf
            strProcedureText = strProcedureText + "							AND (O.TransType NOT IN (13,14,18,19,24,46,203,204) OR (O.TransType IN (24,46) AND O.StornoToTr IS NOT NULL AND LTRIM(RTRIM(O.StornoToTr))<>'') OR (O.TransType IN (13,14,18,19,24,46,203,204) AND (O.Indicator IS NOT NULL AND LTRIM(RTRIM(O.Indicator))<>''))) 			" + vbCrLf
            strProcedureText = strProcedureText + "							AND O.TaxDate BETWEEN @B3 AND @B4				 				" + vbCrLf
            strProcedureText = strProcedureText + "							) AS A WHERE ISNULL(amount,0)>0 			" + vbCrLf
            strProcedureText = strProcedureText + "							ORDER BY  SiralamaTarihi			" + vbCrLf
            strProcedureText = strProcedureText + "				END		 				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "				OPEN @MyCursor						" + vbCrLf
            strProcedureText = strProcedureText + "				FETCH NEXT FROM @MyCursor INTO @bastar, @bittar, @enteredby,  @entereddate,  @entryref,  @linenumber,  @linenumbercounter,  @SatirNo,   @totaldebit, @totalcredit, @documenttype,  @doctypedesc,  @documentnumber,  @documentdate,  @paymentmethod,  @accmainid,  @accmainiddesc,  @accsubdesc,  @accsubid,  @amount, @debitcreditcode,  @postingdate,  @detailcomment,  @entrycomment						" + vbCrLf
            strProcedureText = strProcedureText + "				WHILE @@FETCH_STATUS = 0						" + vbCrLf
            strProcedureText = strProcedureText + "					BEGIN					" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						SET @intsatirMaddeNo = @intsatirMaddeNo +1				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						SET @strfisnoYeni = @entryref				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						If @strfisno = @strfisnoYeni 				" + vbCrLf
            strProcedureText = strProcedureText + "						BEGIN				" + vbCrLf
            strProcedureText = strProcedureText + "							SET @LineId = @LineId + 1			" + vbCrLf
            strProcedureText = strProcedureText + "						END				" + vbCrLf
            strProcedureText = strProcedureText + "						ELSE 				" + vbCrLf
            strProcedureText = strProcedureText + "						BEGIN				" + vbCrLf
            strProcedureText = strProcedureText + "							SET @Yevmiye_Madde_Numarasi = @Yevmiye_Madde_Numarasi + 1			" + vbCrLf
            strProcedureText = strProcedureText + "							SET @LineId = @LineId + 1			" + vbCrLf
            strProcedureText = strProcedureText + "							SET @strfisno = @strfisnoYeni			" + vbCrLf
            strProcedureText = strProcedureText + "						END				" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						IF @documentdate = '1900-01-01'				" + vbCrLf
            strProcedureText = strProcedureText + "							INSERT INTO [dbo].[@ELRAPVB]([DocEntry], [LineId], [VisOrder], [Object], [LogInst], [U_startdate], [U_enddate], [U_entryref], [U_linenumber], [U_linenumbercounter], [U_accmainid], [U_accmainiddesc], [U_accsubid], [U_accsubdesc], [U_amount], [U_totaldebit], [U_totalcredit], [U_debitcreditcode], [U_postingdate], [U_documenttype], [U_doctypedesc], [U_documentnumber], [U_documentreference], [U_documentdate], [U_paymentmethod], [U_detailcomment], [U_enteredby], [U_entereddate], [U_entrynumber], [U_entrycomment])			" + vbCrLf
            strProcedureText = strProcedureText + "								VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @bastar, @bittar, @entryref, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @accmainid, @accmainiddesc, @accsubid, @accsubdesc, @amount, @totaldebit, @totalcredit, @debitcreditcode, @postingdate, @documenttype, @doctypedesc, @documentnumber, @entryref, NULL, @paymentmethod, @detailcomment, @enteredby,  @entereddate, @entryref, @entrycomment)		" + vbCrLf
            strProcedureText = strProcedureText + "						ELSE				" + vbCrLf
            strProcedureText = strProcedureText + "							INSERT INTO [dbo].[@ELRAPVB]([DocEntry], [LineId], [VisOrder], [Object], [LogInst], [U_startdate], [U_enddate], [U_entryref], [U_linenumber], [U_linenumbercounter], [U_accmainid], [U_accmainiddesc], [U_accsubid], [U_accsubdesc], [U_amount], [U_totaldebit], [U_totalcredit], [U_debitcreditcode], [U_postingdate], [U_documenttype], [U_doctypedesc], [U_documentnumber], [U_documentreference], [U_documentdate], [U_paymentmethod], [U_detailcomment], [U_enteredby], [U_entereddate], [U_entrynumber], [U_entrycomment])			" + vbCrLf
            strProcedureText = strProcedureText + "								VALUES(@DocEntry, @LineId, @LineId, 'ELRAP', NULL, @bastar, @bittar, @entryref, @intsatirMaddeNo, @Yevmiye_Madde_Numarasi, @accmainid, @accmainiddesc, @accsubid, @accsubdesc, @amount, @totaldebit, @totalcredit, @debitcreditcode, @postingdate, @documenttype, @doctypedesc, @documentnumber, @entryref, @documentdate, @paymentmethod, @detailcomment, @enteredby,  @entereddate, @entryref, @entrycomment)		" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf
            strProcedureText = strProcedureText + "						FETCH NEXT FROM @MyCursor				" + vbCrLf
            strProcedureText = strProcedureText + "						INTO @bastar, @bittar, @enteredby,  @entereddate,  @entryref,  @linenumber,  @linenumbercounter,  @SatirNo,   @totaldebit, @totalcredit, @documenttype,  @doctypedesc,  @documentnumber,  @documentdate,  @paymentmethod,  @accmainid,  @accmainiddesc,  @accsubdesc,  @accsubid,  @amount, @debitcreditcode,  @postingdate,  @detailcomment,  @entrycomment				" + vbCrLf
            strProcedureText = strProcedureText + "					END					" + vbCrLf
            strProcedureText = strProcedureText + "				CLOSE @MyCursor						" + vbCrLf
            strProcedureText = strProcedureText + "				DEALLOCATE @MyCursor						" + vbCrLf
            strProcedureText = strProcedureText + "										" + vbCrLf

            oGFun.CreateProcedure("sp_EDefterGrid4", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub

    Public Sub CreateEDefterGrid4_HANA()
        Try
            Dim strProcedureText As String = ""
            
            Dim strPath As String = System.Windows.Forms.Application.StartupPath & "\Script\sp_EDefterGrid4.txt"
            strProcedureText = File.ReadAllText(strPath)

            oGFun.CreateProcedure("SP_EDEFTERGRID4", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
    Public Sub CreateEDefterText4()
        Try
            Dim strProcedureText As String = ""
            strProcedureText = strProcedureText + "CREATE PROCEDURE [dbo].[sp_EDefterText4] --2,'trtr'" + vbCrLf
            strProcedureText = strProcedureText + "(" + vbCrLf
            strProcedureText = strProcedureText + "@DocEntry int," + vbCrLf
            strProcedureText = strProcedureText + "@CompanyName nvarchar(100) " + vbCrLf
            strProcedureText = strProcedureText + ")" + vbCrLf
            strProcedureText = strProcedureText + "AS" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "--DECLARE  @DocEntry int  " + vbCrLf
            strProcedureText = strProcedureText + "--SET @DocEntry = 1" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @Satir nvarchar(max), @intSatir int, @AyAdi nvarchar(50)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @bastar date, @bittar date, @entrynumber nvarchar(50), @documentreference nvarchar(50)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @entryref nvarchar(50), @enteredby  nvarchar(50), @entereddate  date, @linenumber  int, @linenumbercounter  int" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @documenttype  nvarchar(50), @doctypedesc  nvarchar(100), @documentnumber  nvarchar(30)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @documentdate  date, @paymentmethod  nvarchar(100), @accmainid  nvarchar(50)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @accmainiddesc  nvarchar(100), @accsubdesc  nvarchar(200),  @accsubid  nvarchar(50)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @debitcreditcode  char(1), @postingdate  nvarchar(8), @detailcomment  nvarchar(250)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @entrycomment nvarchar(200),  @amount  numeric(19,2),@totaldebit numeric(19,2), @totalcredit numeric(19,2)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @Satir_Madde_No int,  @intsatirMaddeNo int,  @strfisnoYeni nvarchar(50),  @strfisno nvarchar(50),  @LineId int" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @yevmiyemaddeno nvarchar(10), @yeniyevmiyeno int, @fisno nvarchar(20), @ArtanSatirNo as nvarchar(5), @dokno nvarchar(30)" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @bittar2 char(2), @bastar2 char(2), @doktarih nvarchar(10), @ilkfisno nvarchar(50)" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "SET @ilkfisno = ''" + vbCrLf
            strProcedureText = strProcedureText + "SET @intSatir = 0" + vbCrLf
            strProcedureText = strProcedureText + "SET @yeniyevmiyeno = 0" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "CREATE TABLE #TempTable(ID int, SatirDeger nvarchar(max))" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "DECLARE @MyCursor CURSOR" + vbCrLf
            strProcedureText = strProcedureText + "SET @MyCursor = CURSOR FAST_FORWARD" + vbCrLf
            strProcedureText = strProcedureText + "FOR" + vbCrLf
            strProcedureText = strProcedureText + "	SELECT  [U_startdate],[U_enddate],[U_entryref],[U_linenumber],[U_linenumbercounter],[U_accmainid], REPLACE(REPLACE([U_accmainiddesc],'"" ',''),'''',''),[U_accsubid], REPLACE(REPLACE([U_accsubdesc],'""',''),'''',''),ISNULL([U_amount],0),[U_totaldebit],[U_totalcredit],[U_debitcreditcode],[U_postingdate],REPLACE(REPLACE([U_documenttype],'""',''),'''',''), REPLACE(REPLACE([U_doctypedesc],'""',''),'''',''), REPLACE(REPLACE([U_documentnumber],'""',''),'''',''),[U_documentreference],[U_documentdate],REPLACE(REPLACE([U_paymentmethod],'""',''),'''',''), REPLACE(REPLACE([U_detailcomment],'""',''),'''',''),[U_entereddate],[U_entrynumber],REPLACE(REPLACE([U_entrycomment],'""',''),'''','') FROM [dbo].[@ELRAPVB](NOLOCK) WHERE [DocEntry] = @DocEntry AND ISNULL([U_amount],0)>0	" + vbCrLf
            strProcedureText = strProcedureText + "OPEN @MyCursor" + vbCrLf
            strProcedureText = strProcedureText + "FETCH NEXT FROM @MyCursor INTO @bastar, @bittar, @entryref, @linenumber, @linenumbercounter,  @accmainid,  @accmainiddesc,  @accsubid, @accsubdesc, @amount, @totaldebit, @totalcredit, @debitcreditcode, @postingdate, @documenttype,  @doctypedesc,  @documentnumber, @documentreference, @documentdate, @paymentmethod, @detailcomment, @entereddate, @entrynumber, @entrycomment	" + vbCrLf
            strProcedureText = strProcedureText + "WHILE @@FETCH_STATUS = 0" + vbCrLf
            strProcedureText = strProcedureText + "	BEGIN	" + vbCrLf
            strProcedureText = strProcedureText + "SET @intSatir = @intSatir + 1" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "IF @intSatir = 1 " + vbCrLf
            strProcedureText = strProcedureText + "BEGIN" + vbCrLf
            strProcedureText = strProcedureText + "	SET @AyAdi = ''	" + vbCrLf
            strProcedureText = strProcedureText + "	IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 1	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'January'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 2	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'February'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 3	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'March'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 4	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'April'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 5	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'May'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 6	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'June'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 7	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'July'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 8	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'Agust'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 9	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'September'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 10	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'October'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF CONVERT(nvarchar,DATEPART(MM,@bastar))= 11	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'November'" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE 	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @AyAdi = 'December'" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "	IF LEN(CONVERT(nvarchar,DATEPART(DD,@bittar)))=1	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @bittar2 = '0' + CONVERT(nvarchar,DATEPART(DD,@bittar))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(CONVERT(nvarchar,DATEPART(DD,@bittar)))=2	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @bittar2 = CONVERT(nvarchar,DATEPART(DD,@bittar))" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "	IF LEN(CONVERT(nvarchar,DATEPART(DD,@bastar)))=1	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @bastar2 = '0' + CONVERT(nvarchar,DATEPART(DD,@bastar))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(CONVERT(nvarchar,DATEPART(DD,@bastar)))=2	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @bastar2 = CONVERT(nvarchar,DATEPART(DD,@bastar))" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "SET @Satir = 'HDR: ""JOURNAL"" ""' + CONVERT(nvarchar,DATEPART(YYYY,@bastar)) + '-01-01"" ""' + CONVERT(nvarchar,DATEPART(YYYY,@bastar)) + '-12-31"" ""' + CONVERT(VARCHAR(10), @bastar, 120) + '"" ""' + CONVERT(VARCHAR(10), @bittar, 120) + '"" ""YEV' + CONVERT(VARCHAR(8), @bastar, 112) + ' ' + @bittar2 + '"" ""JOURNAL kept by ' + @CompanyName + ' for the period between ' + @bastar2 + ' ' + @AyAdi + ' ' + CONVERT(nvarchar,DATEPART(YYYY,@bastar)) + ' and ' + @bittar2 + ' ' + @AyAdi + ' ' + CONVERT(nvarchar,DATEPART(YYYY,@bittar)) + ' ""'" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "	INSERT INTO #TempTable SELECT @intSatir, @Satir	" + vbCrLf
            strProcedureText = strProcedureText + "END" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "IF @yeniyevmiyeno<> @linenumbercounter" + vbCrLf
            strProcedureText = strProcedureText + "BEGIN" + vbCrLf
            strProcedureText = strProcedureText + "	SET @intSatir = @intSatir + 1	" + vbCrLf
            strProcedureText = strProcedureText + "	IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=1	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '000000000' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=2	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '00000000' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=3	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '0000000' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=4	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '000000' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=5	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '00000' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=6	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '0000' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=7	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '000' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=8	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '00' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))))=9	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = '0' + LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE 	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @yevmiyemaddeno = LTRIM(RTRIM(CONVERT(NVARCHAR,@linenumbercounter))) " + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "	SET @fisno = ''	" + vbCrLf
            strProcedureText = strProcedureText + "	IF LTRIM(RTRIM(@entryref)) = 1	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @fisno = '000000' +  @entryref" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LTRIM(RTRIM(@entryref)) = 2	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @fisno = '00000' +  @entryref" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LTRIM(RTRIM(@entryref)) = 3	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @fisno = '0000' +  @entryref" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LTRIM(RTRIM(@entryref)) = 4	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @fisno = '000' +  @entryref" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LTRIM(RTRIM(@entryref)) = 5	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @fisno = '00' +  @entryref" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LTRIM(RTRIM(@entryref)) = 6	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @fisno = '0' +  @entryref" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LTRIM(RTRIM(@entryref)) >= 7	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @fisno = @entryref" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "SET @Satir = 'Y:""' + @yevmiyemaddeno + '"" ""' + CONVERT(NVARCHAR,ISNULL(@totaldebit,0)) + '"" ""' + CONVERT(NVARCHAR,ISNULL(@totalcredit,0)) + '"" ""' + CONVERT(VARCHAR(10), @entereddate, 120) + '"" ""' + ISNULL(@entryref,'') + '"" ""'	+ ISNULL(@entrycomment,'') + '""'	" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "	INSERT INTO #TempTable SELECT @intSatir, @Satir	" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "	SET @yeniyevmiyeno = @linenumbercounter	" + vbCrLf
            strProcedureText = strProcedureText + "END" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "SET @intSatir = @intSatir + 1" + vbCrLf
            strProcedureText = strProcedureText + "SET @ArtanSatirNo = ''" + vbCrLf
            strProcedureText = strProcedureText + "IF LEN(LTRIM(RTRIM(CONVERT(nvarchar,@linenumber))))=1" + vbCrLf
            strProcedureText = strProcedureText + "	    SET @ArtanSatirNo= '00' + LTRIM(RTRIM(CONVERT(nvarchar, @linenumber)))	" + vbCrLf
            strProcedureText = strProcedureText + "ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @linenumber))))=2" + vbCrLf
            strProcedureText = strProcedureText + "	    SET @ArtanSatirNo= '0' + LTRIM(RTRIM(CONVERT(nvarchar, @linenumber)))	" + vbCrLf
            strProcedureText = strProcedureText + "ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @linenumber))))=3" + vbCrLf
            strProcedureText = strProcedureText + "	    SET @ArtanSatirNo= LTRIM(RTRIM(CONVERT(nvarchar, @linenumber)))	" + vbCrLf
            strProcedureText = strProcedureText + "ELSE" + vbCrLf
            strProcedureText = strProcedureText + "	    SET @ArtanSatirNo= LTRIM(RTRIM(CONVERT(nvarchar, @linenumber)))	" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "IF @ilkfisno <> @entryref" + vbCrLf
            strProcedureText = strProcedureText + "BEGIN" + vbCrLf
            strProcedureText = strProcedureText + "	SET @ilkfisno = @entryref	" + vbCrLf
            strProcedureText = strProcedureText + "	SET @dokno = ''	" + vbCrLf
            strProcedureText = strProcedureText + "	IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))))=1	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @dokno= '000000' + LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))) " + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))))=2	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @dokno= '00000' + LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))))=3	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @dokno= '0000' + LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))))=4	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @dokno= '000' + LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))))=5	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @dokno= '00' + LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))))=6	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @dokno= '0' + LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber)))" + vbCrLf
            strProcedureText = strProcedureText + "	ELSE IF LEN(LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber))))>=7	" + vbCrLf
            strProcedureText = strProcedureText + "     SET @dokno= LTRIM(RTRIM(CONVERT(nvarchar, @documentnumber)))" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "END" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "SET @doktarih = CONVERT(nvarchar(10), @documentdate, 120)" + vbCrLf
            strProcedureText = strProcedureText + "IF @doktarih = '1900-01-01' " + vbCrLf
            strProcedureText = strProcedureText + "	SET @doktarih = ''	" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "	SET @Satir = 'YD:""' + LTRIM(RTRIM(ISNULL(@accmainid,''))) + '"" ""' + LTRIM(RTRIM(ISNULL(@accmainiddesc,''))) + '"" ""' + @ArtanSatirNo + '"" ""' + LTRIM(RTRIM(ISNULL(@accsubid,''))) + '"" ""' +  LTRIM(RTRIM(ISNULL(@accsubdesc,''))) + '"" ""' + LTRIM(RTRIM(CONVERT(nvarchar,ISNULL(@amount,0)))) + '"" ""' + LTRIM(RTRIM(ISNULL(@debitcreditcode,''))) + '"" ""' + LTRIM(RTRIM(ISNULL(@paymentmethod, ''))) + '"" ""' + LTRIM(RTRIM(ISNULL(@documenttype,''))) + '"" ""' + LTRIM(RTRIM(ISNULL(@doctypedesc,''))) + '"" ""' + LTRIM(RTRIM(ISNULL(@dokno,''))) + '"" ""' + LTRIM(RTRIM(ISNULL(@doktarih,''))) + '""'	" + vbCrLf
            strProcedureText = strProcedureText + "--SELECT ISNULL(@accmainid,'') , ISNULL(@accmainiddesc,'') , @ArtanSatirNo , ISNULL(@accsubid,'') ,  ISNULL(@accsubdesc,'') , CONVERT(nvarchar,ISNULL(@amount,0)) , ISNULL(@debitcreditcode,'') , ISNULL(@paymentmethod, '') , ISNULL(@documenttype,'') , ISNUL" + vbCrLf
            strProcedureText = strProcedureText + "INSERT INTO #TempTable SELECT @intSatir, @Satir" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "FETCH NEXT FROM @MyCursor" + vbCrLf
            strProcedureText = strProcedureText + "INTO @bastar, @bittar, @entryref, @linenumber, @linenumbercounter,  @accmainid,  @accmainiddesc,  @accsubid, @accsubdesc, @amount, @totaldebit, @totalcredit, @debitcreditcode, @postingdate, @documenttype,  @doctypedesc,  @documentnumber, @documentreference, @documentdate, @paymentmethod, @detailcomment, @entereddate, @entrynumber, @entrycomment" + vbCrLf
            strProcedureText = strProcedureText + "	END	" + vbCrLf
            strProcedureText = strProcedureText + "CLOSE @MyCursor" + vbCrLf
            strProcedureText = strProcedureText + "DEALLOCATE @MyCursor" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "SELECT SatirDeger FROM #TempTable ORDER BY ID" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf
            strProcedureText = strProcedureText + "DROP TABLE #TempTable" + vbCrLf
            strProcedureText = strProcedureText + "" + vbCrLf

            oGFun.CreateProcedure("sp_EDefterText4", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
    Public Sub CreateEDefterText4_HANA()
        Try
            Dim strProcedureText As String = ""

            Dim strPath As String = System.Windows.Forms.Application.StartupPath & "\Script\sp_EDefterText4.txt"
            strProcedureText = File.ReadAllText(strPath)
            
            oGFun.CreateProcedure("SP_EDEFTERTEXT4", strProcedureText)
        Catch ex As Exception
            oApplication.StatusBar.SetText(ex.Message)

        End Try
    End Sub
#End Region
End Class
